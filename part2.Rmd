---
title: "Comparing validation methods"
author: "me"
date: "4 joulukuuta 2019"
output: html_document
---
#

```{r , include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r }
# SET DIRECTORIES (START) ####################################################################
getwd()
localDir = "."
PredictionDir = file.path(localDir, "data")
```

```
```{r }
# SET DIRECTORIES AND LOAD LIBRARIES

setwd("C:/Users/U1701911/OneDrive - University of Helsinki/mallinnus/ennusteet/csc_models")
#setwd("C:/Users/Sirke Piirainen/OneDrive - University of Helsinki/mallinnus/ennusteet/csc_models")

packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools")
lapply(packages,library,character.only=T)

#read data
pa <- read_delim("pa_results.csv", ",", 
                      escape_double = FALSE, trim_ws = TRUE)
abu <- read_delim("abu_results.csv", ",", 
                       escape_double = FALSE, trim_ws = TRUE)

#combine data frames
res=inner_join(pa,abu,by="species")

#save as csv for further analysis
write.csv(res,"results.csv",row.names = F)

#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
```

```{r }
#testataan onko merkitsevää eroa
#A ja B välillä
#pa
t.test(res$pa_A,res$pa_B, paired=TRUE)
#abu
t.test(res$abu_A,res$abu_B, paired=TRUE)
```

```{r }
#A pa ja abu välillä
t.test(res$pa_A,res$abu_A, paired=TRUE)
#B pa ja abu välillä
t.test(res$pa_B,res$abu_B, paired=TRUE)
```

```{r }
#change pa ja abu välillä
t.test(res$pa_D,res$abu_D, paired=TRUE)
```

```{r }
# Piirretään kuvaaja, Figure 1ABCDEF
#mitä oikeastaan halutaan vertailla?

#määritetään kuvalle raamit ja nimi
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)

Line=cbind(Line,Line2)
Line=cbind(Line,Line3)

Line=as.data.frame(Line)

pdf("Fig1abcdef.pdf")
#jpeg("Fig1abcdef.jpeg")
#png("Fig1abcdef.png")

#määrittää 3x3 matriisin johon kuvat piirretään, esim. seitsemättä kuvaa ei ole joten
#se jää piirtämättä.
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))

# a)
plot(pa_B~pa_A,data=res,xlim=c(-1,1),
     ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
     ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")

text(-0.5,0.8,"a) Distribution",cex=0.8)


# b)
plot(abu_B~abu_A,data=res,xlim=c(-1,1),
     ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
     ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")

text(-0.5,0.8,"b) Abundance",cex=0.8)

# c)
plot(pa_D~pa_A,data=res,xlim=c(-1,1),
     ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
     ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")

text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)

# d)
plot(abu_D~abu_A,data=res,xlim=c(-1,1),
     ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
     ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")

text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)

# e) 
plot(pool_pa~pa_past,data=res,xlim=c(-1,1),
     ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (past)",
     ylab="Prediction accuracy (change)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")

text(-0.5,0.8,"e) Distribution, 50 km",cex=0.8)

# f)
plot(pool_abu~abu_past,data=res,xlim=c(-1,1),
     ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (past)",
     ylab="Prediction accuracy (change)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")

text(-0.5,0.8,"f) Abundance, 50km", cex=0.8)

dev.off()
```








