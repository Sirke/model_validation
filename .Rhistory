}}
#matriisit on muutettava dataframeiksi
Ap1=as.data.frame(Ap1)
Ap1=cbind(selroutes,Ap1)
setnames(Ap1,"selroutes","Route")
Ap2=as.data.frame(Ap2)
Ap2=cbind(selroutes,Ap2)
setnames(Ap2,"selroutes","Route")
Ay1=as.data.frame(Ay1)
Ay1=cbind(selroutes,Ay1)
setnames(Ay1,"selroutes","Route")
Ay2=as.data.frame(Ay2)
Ay2=cbind(selroutes,Ay2)
setnames(Ay2,"selroutes","Route")
#lisätään havaintoihin ja ennusteisiin ensin oikeat reittikoodit (1-2591)
Ap1<-left_join(Ap1,d,by="Route")
Ap2<-left_join(Ap2,d,by="Route")
Ay1<-left_join(Ay1,d,by="Route")
Ay2<-left_join(Ay2,d,by="Route")
#...ja koordinaatit
Ap1<-left_join(Ap1,xy,by=c("routeid"="route"))
Ap2<-left_join(Ap2,xy,by=c("routeid"="route"))
Ay1<-left_join(Ay1,xy,by=c("routeid"="route"))
Ay2<-left_join(Ay2,xy,by=c("routeid"="route"))
#save observations and predictions for pooling in GIS
write.csv(Ay1,"abu_obs_per1.csv",row.names = F)
write.csv(Ay2,"abu_obs_per2.csv",row.names = F)
write.csv(Ap1,"abu_pred_per1.csv",row.names = F)
write.csv(Ap2,"abu_pred_per2.csv",row.names = F)
#luetaan sisään reitit koordinaatteineen
coordinates(Ay1)<-c("x","y")
plot(Ay1)
proj4string(Ay1) <-CRS("+init=EPSG:3035")
coordinates(Ay2)<-c("x","y")
proj4string(Ay2) <-CRS("+init=EPSG:3035")
coordinates(Ap1)<-c("x","y")
proj4string(Ap1) <-CRS("+init=EPSG:3035")
coordinates(Ap2)<-c("x","y")
proj4string(Ap2) <-CRS("+init=EPSG:3035")
#join data based on polygons
pts.poly <- point.in.poly(Ay1, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>% #NA:t eivät vaikuta laskuihin
write.csv(.,file = "pool_abu_obs_per1.csv",row.names=F,na="")
pts.poly <- point.in.poly(Ay2, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_abu_obs_per2.csv",row.names=F,na="")
pts.poly <- point.in.poly(Ap1, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_abu_pred_per1.csv",row.names=F,na="")
pts.poly <- point.in.poly(Ap2, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_abu_pred_per2.csv",row.names=F,na="")
paY1<-read.csv("pool_abu_obs_per1.csv",header=T,sep=",")
paY2<-read.csv("pool_abu_obs_per2.csv",header=T,sep=",")
papred1<-read.csv("pool_abu_pred_per1.csv",header=T,sep=",")
papred2<-read.csv("pool_abu_pred_per2.csv",header=T,sep=",")
#heivataan turhat sarakkeet
drops <- c("routeid","left","top","right","bottom","coords.x1","coords.x2")
paY1<-paY1[ , !(names(paY1) %in% drops)]
paY2<-paY2[ , !(names(paY2) %in% drops)]
papred1<-papred1[ , !(names(papred1) %in% drops)]
papred2<-papred2[ , !(names(papred2) %in% drops)]
#korjataan sarakkeiden lajinimet kunnollisiksi
a<-colnames(Y)
b<-"grid_id"
a<-c(b,a)
names(paY1)<-a
names(paY2)<-a
names(papred1)<-a
names(papred2)<-a
#seuraavaksi lasketaan erotukset periodin 1 ja 2 välilä
#abu
#obs
pacounts_gather<-gather(paY1,key="Yspecies",value="Yper1",Acrocephalus_palustris:Vanellus_vanellus)
pacounts_gather2<-gather(paY2,key="Yspecies",value="Yper2",Acrocephalus_palustris:Vanellus_vanellus)
payhd<-left_join(pacounts_gather,pacounts_gather2,by=c("grid_id"="grid_id","Yspecies"="Yspecies"))
payhd$difY<-payhd$Yper2-payhd$Yper1
#pred
papred_gather<-gather(papred1,key="Pspecies",value="Pper1",Acrocephalus_palustris:Vanellus_vanellus)
papred_gather2<-gather(papred2,key="Pspecies",value="Pper2",Acrocephalus_palustris:Vanellus_vanellus)
payhdPred<-left_join(papred_gather,papred_gather2,by=c("grid_id"="grid_id","Pspecies"="Pspecies"))
payhdPred$difPred<-payhdPred$Pper2-payhdPred$Pper1
#pa
abuKor<-left_join(payhd,payhdPred,by=c("grid_id"="grid_id","Yspecies"="Pspecies"))
keep<-c("Yspecies","difPred","difY")
abuKor<-abuKor[,keep,drop=F]
abuKor %>%
group_by(Yspecies) %>%
dplyr::summarise(pool_abu_change= cor(difPred, difY, use= "na.or.complete"))%T>%
write.csv('abu_pool50_results.csv',row.names=F)
observations=abuKor %>%
group_by(Yspecies) %>%
dplyr::summarise(Ngrid= length(which(!is.na(difPred))))
observations
res$P_D=NULL
res<-read.csv("results.csv")
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
#poistan perustuloksista P_D sarakkeen
res$P_D=NULL
pool_res<-inner_join(pool_pa,pool_abu,by="Yspecies")
res2<-inner_join(res,pool_res,by=c("species"="Yspecies"))
#tallennetaan omaksi taulukokseen jatkoa varten
write.csv(res2,"results_and_pooled.csv",row.names = F)
##lasketaan kaikille arvoille keskiarvot ja se:t
res2 %>% dplyr::select(2:11)%>%colMeans()
res2 %>% dplyr::select(2:11)%>%std.error()
#muokataan aineistoa
res3=res2[c(1,2,3,4,5,10,6,7,8,9,11)]
res3=gather(res3,"method","accuracy",2:11)
res3$method=as.factor(res3$method)
#plottailua
p=ggplot(res3,aes(x=method,y=accuracy))+geom_boxplot()
p + scale_x_discrete(limits=c("pa_A", "pa_B","pa_C","pa_D","pool_pa_change"))
p+ scale_x_discrete(limits=c("abu_A", "abu_B","abu_C","abu_D","pool_abu_change"))
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","plyr","dplyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4","nlme")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
str(res)
res$abu_D[res$P_D<10]=NA
res$abu_C[res$P_D<10]=NA
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans(.,na.rm = T)
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[c(-1,-10)])
abline(h=0)
#aineiston muokkaus:
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D")))
res_pa$pa=as.factor("pa")
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(revalue(res_abu$method,c("abu_A"="A","abu_B"="B","abu_C"="C","abu_D"="D")))
res_abu$pa=as.factor("abu")
res2=rbind(res_pa,res_abu)
str(res2)
summary(res2)
View(res2)
ggplot(res2,aes(x=method, y=accuracy))+geom_boxplot()+facet_grid(.~pa)
write.csv(res2,"results_with_NA.csv",row.names = F)
res<-read.csv("results_with_NA.csv")
View(res)
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
pool_res<-inner_join(pool_pa,pool_abu,by="Yspecies")
View(pool_res)
pool_res=gather(pool_res,"method","accuracy",2:3)
View(res)
pool_pa$pa="pa"
pool_abu$pa="abu"
pool_res<-inner_join(pool_pa,pool_abu,by="Yspecies")
View(pool_abu)
pool_res=rbind(pool_pa,pool_abu)
res<-read.csv("results_with_NA.csv")
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
View(pool_abu)
pool_pa$method="pool_D"
View(pool_pa)
pool_pa$pa="pa"
pool_abu$method="pool_D"
pool_abu$pa="abu"
pool_pa<-read.csv("pa_pool50_results.csv")
pool_pa$method=as.factor("pool_D")
pool_abu<-read.csv("abu_pool50_results.csv")
pool_abu$method=as.factor("pool_D")
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
#100km gridi
#pool_pa<-read.csv("pa_pool100_results.csv")
#pool_abu<-read.csv("abu_pool100_results.csv")
#muokataan taulukoita
pool_pa$method=as.factor("pool_D")
pool_pa$pa=as.factor("pa")
pool_abu$method=as.factor("pool_D")
pool_abu$pa=as.factor("abu")
pool_pa %>%
rename(
species = Yspecies,
pool_pa_change = method
)
pool_abu %>%
rename(
species = Yspecies,
pool_abu_change = method
)
res2=rbind(res,pool_abu,pool_pa)
pool_pa=pool_pa %>%
rename(
species = Yspecies,
pool_pa_change = method
)
pool_abu=pool_abu %>%
rename(
species = Yspecies,
pool_abu_change = method
)
res2=rbind(res,pool_abu,pool_pa)
pool_pa=pool_pa %>%
rename(
species = Yspecies,
pool_pa_change = method
)
pool_pa=pool_pa %>%
rename(
species = Yspecies,
pool_pa_change = method)
pa=pool_pa %>%
rename(
species = Yspecies,
pool_pa_change = method)
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
#100km gridi
#pool_pa<-read.csv("pa_pool100_results.csv")
#pool_abu<-read.csv("abu_pool100_results.csv")
#muokataan taulukoita
pool_pa$method=as.factor("pool_D")
pool_pa$pa=as.factor("pa")
pool_abu$method=as.factor("pool_D")
pool_abu$pa=as.factor("abu")
pa=pool_pa %>%
rename(
species = Yspecies,
pool_pa_change = method)
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
#100km gridi
#pool_pa<-read.csv("pa_pool100_results.csv")
#pool_abu<-read.csv("abu_pool100_results.csv")
#muokataan taulukoita
pool_pa$method=as.factor("pool_D")
pool_pa$pa=as.factor("pa")
pool_abu$method=as.factor("pool_D")
pool_abu$pa=as.factor("abu")
pool_pa=pool_pa %>%
rename(
species = Yspecies,
pool_pa_change = method)
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
pool_pa$method=as.factor("pool_D")
pool_pa$pa=as.factor("pa")
pool_abu$method=as.factor("pool_D")
pool_abu$pa=as.factor("abu")
pool_pa=pool_pa %>%
rename(
species = Yspecies,
accuracy = pool_pa_change)
pool_abu=pool_abu %>%
rename(
species = Yspecies,
accuracy = pool_abu_change
)
res2=rbind(res,pool_abu,pool_pa)
View(res2)
str(res2)
summary(res2)
res2$accuracy[res2$species == "Emberiza_rustica" | res2$method == "pool_D" | res2$pa == "abu"] <- "NA"
res<-read.csv("results_with_NA.csv")
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
#100km gridi
#pool_pa<-read.csv("pa_pool100_results.csv")
#pool_abu<-read.csv("abu_pool100_results.csv")
#muokataan taulukoita
pool_pa$method=as.factor("pool_D")
pool_pa$pa=as.factor("pa")
pool_abu$method=as.factor("pool_D")
pool_abu$pa=as.factor("abu")
pool_pa=pool_pa %>%
rename(
species = Yspecies,
accuracy = pool_pa_change)
pool_abu=pool_abu %>%
rename(
species = Yspecies,
accuracy = pool_abu_change
)
#yhdistetään kaikki tulokset samaan taulukkoon
res2=rbind(res,pool_abu,pool_pa)
str(res2)
summary(res2)
res2$accuracy[res2$species == "Emberiza_rustica" & res2$method == "pool_D" & res2$pa == "abu"] <- "NA"
res2$accuracy[res2$species == "Bonasa_bonasia" & res2$method == "pool_D" & res2$pa == "abu"] <- "NA"
p=ggplot(res2,aes(x=method,y=accuracy))+geom_boxplot()
p
boxplot(accuracy~pa*method,data=res2)
res<-read.csv("results_with_NA.csv")
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
#100km gridi
#pool_pa<-read.csv("pa_pool100_results.csv")
#pool_abu<-read.csv("abu_pool100_results.csv")
#muokataan taulukoita
pool_pa$method=as.factor("pool_D")
pool_pa$pa=as.factor("pa")
pool_abu$method=as.factor("pool_D")
pool_abu$pa=as.factor("abu")
pool_pa=pool_pa %>%
rename(
species = Yspecies,
accuracy = pool_pa_change)
pool_abu=pool_abu %>%
rename(
species = Yspecies,
accuracy = pool_abu_change
)
#yhdistetään kaikki tulokset samaan taulukkoon
res2=rbind(res,pool_abu,pool_pa)
str(res2)
summary(res2)
res2$accuracy[res2$species == "Emberiza_rustica" & res2$method == "pool_D" & res2$pa == "abu"] <- NA
res2$accuracy[res2$species == "Bonasa_bonasia" & res2$method == "pool_D" & res2$pa == "abu"] <- NA
boxplot(accuracy~pa*method,data=res2)
ggplot(res2, aes(x = method, y = accuracy, interaction = pa, colour = pa)) + geom_boxplot()
res3=res2[res2$method == "D" & res2$method == "pool_D"]
res3=res2[res2$method == "D" & res2$method == "pool_D"]
View(res3)
res3 <- res2[ which(method=='D' | 'pool_D'),]
res3 <- res2[ which(res$method=='D' | 'pool_D'),]
res3 <- res2[ which(res$method=='D' | res$method=='pool_D'),]
View(res3)
res3 <- res2[ which(res$method=='D' & res$method=='pool_D'),]
View(res3)
res3 <- res2[ which(res$method=='D' | res$method=='pool_D'),]
View(res3)
res3=subset(res2,method=="D"|method=="pool_D")
ggplot(res3, aes(x = method, y = accuracy, interaction = pa, colour = pa)) + geom_boxplot()
res3%>%
group_by(method)
res3%>%
group_by(method,pa)
res3%>%
group_by(method,pa) %>%
mean(accuracy)
res3%>%
group_by(method,pa) %>%
mean(accuracy,na.rm=T)
res3%>%
group_by(method,pa) %>%
summarise(means=mean(accuracy,na.rm=T))
res3%>%
group_by(method,pa) %>%
summarise(means=mean(accuracy,na.rm=T))%>%
summarise(std.errors=std.error(accuracy,na.rm=T))
res3%>%
group_by(method,pa) %>%
summarise(means=mean(accuracy,na.rm=T),std.errors=std.error(accuracy,na.rm=T))
A1=lme(accuracy~method*pa,data=res3,random=~1|species,method="ML",na.action="na.exclude")
A2=lme(accuracy~method+pa,data=res3,random=~1|species,method="ML",na.action="na.exclude")
A3=lme(accuracy~method,data=res3,random=~1|species,method="ML",na.action="na.exclude")
A4=lme(accuracy~pa,data=res3,random=~1|species,method="ML",na.action="na.exclude")
anova(A1,A2)
AIC(A1,A2,A3,A4)
summary(A1)
anova(A1)
plot(A1)
E1=resid(A1, type="normalized")
F1=fitted(A1)
par(mfrow=c(2,2), mar=c(5,5,2,2))
plot(x=F1,y=E1,xlab="fitted",ylab="residuals")
abline(h=0,lty=2)
boxplot(E1~method,xlab="method",ylab="residuals",data=res2)
E1=resid(A1, type="normalized")
F1=fitted(A1)
par(mfrow=c(2,2), mar=c(5,5,2,2))
plot(x=F1,y=E1,xlab="fitted",ylab="residuals")
abline(h=0,lty=2)
boxplot(E1~method,xlab="method",ylab="residuals",data=res3)
abline(h=0,lty=2)
boxplot(E1~pa,xlab="pa",ylab="residuals",data=res3)
abline(h=0,lty=2)
par(mfrow=c(1,1), mar=c(5,5,2,2))
boxplot(E1~species,xlab="species",ylab="residuals",data=res3)
abline(h=0,lty=2)
A1_final=lme(accuracy~method*pa,data=res3,random=~1|species,method="REML",na.action="na.exclude")
plot(A1_final)
E1=resid(A1_final, type="normalized")
F1=fitted(A1_final)
par(mfrow=c(2,2), mar=c(5,5,2,2))
plot(x=F1,y=E1,xlab="fitted",ylab="residuals")
abline(h=0,lty=2)
boxplot(E1~method,xlab="method",ylab="residuals",data=res3)
abline(h=0,lty=2)
boxplot(E1~pa,xlab="pa",ylab="residuals",data=res3)
abline(h=0,lty=2)
par(mfrow=c(1,1), mar=c(5,5,2,2))
boxplot(E1~species,xlab="species",ylab="residuals",data=res3)
abline(h=0,lty=2)
View(res)
summary(A1_final)
View(res2)
write.csv(res2,"results_and_pooled.csv",row.names=F)
knitr::opts_chunk$set(echo = TRUE)
getwd()
paketit<-c("nlme","readr","tidyr","dplyr","plyr","magrittr","purrr","ggplot2","ape","geiger","MuMIn","psych","Hmisc")
lapply(paketit,library,character.only=T)
res<-read.csv("results_and_pooled.csv")
spread(res,pa,method)
spread(res,method,pa)
res2=spread(res,method,pa)
View(res2)
knitr::opts_chunk$set(echo = TRUE)
getwd()
paketit<-c("nlme","readr","tidyr","dplyr","plyr","magrittr","purrr","ggplot2","ape","geiger","MuMIn","psych","Hmisc")
lapply(paketit,library,character.only=T)
res<-read.csv("results_and_pooled.csv")
View(res)
res2=subset(res,method=="pool_D")
View(res2)
res3=spread(res2,method,pa)
View(res3)
res<-read.csv("results_and_pooled.csv")
res2=subset(res,method=="pool_D")
res3=spread(res2,pa,accuracy)
View(res3)
res3$method=NULL
res3=res_3 %>%
rename(
pool_pa_change = pa,
pool_abu_change = abu)
res3=res3 %>%
rename(
pool_pa_change = pa,
pool_abu_change = abu)
traits<-read.csv("traits_table.csv",sep = ";")
results<-inner_join(res3,traits,by="species")
View(results)
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pool_pa_change~Hab,data=results,ylab="pool_pa_D",xlab="Habitat")
plot(pool_pa_change~Prev, data = results,ylab="pool_pa_D",xlab="Prevalence")
abline(lm(pool_pa_change~Prev,data = results))
boxplot(pool_pa_change~Mig,data=results,ylab="pool_pa_D",xlab="Migration")
plot(pool_pa_change~logmass, data = results,ylab="pool_pa_D",xlab="log(Mass)")
#kuvaajien piirtely ei (ainakaan multa) onnistu jos log(Mass) ei ole valmiiksi laskettu omaan
#sarakkeeseensa
results$logmass<-log(results$Mass)
#poolattu pa aineisto
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pool_pa_change~Hab,data=results,ylab="pool_pa_D",xlab="Habitat")
plot(pool_pa_change~Prev, data = results,ylab="pool_pa_D",xlab="Prevalence")
abline(lm(pool_pa_change~Prev,data = results))
boxplot(pool_pa_change~Mig,data=results,ylab="pool_pa_D",xlab="Migration")
plot(pool_pa_change~logmass, data = results,ylab="pool_pa_D",xlab="log(Mass)")
abline(lm(pool_pa_change~logmass,data = results))
par(op)
#poolattu abu aineisto
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pool_abu_change~Hab,data=results,ylab="pool_abu_D",xlab="Habitat")
plot(pool_abu_change~Prev, data = results,ylab="pool_abu_D",xlab="Prevalence")
abline(lm(pool_abu_change~Prev,data = results))
boxplot(pool_abu_change~Mig,data=results,ylab="pool_abu_D",xlab="Migration")
plot(pool_abu_change~logmass, data = results,ylab="pool_abu_D",xlab="log(Mass)")
abline(lm(pool_abu_change~logmass,data = results))
par(op)
#luetaan aineisto sisään, Multiphylo eli monta puuta
linnut <- read.nexus("output.nex")
#valitaan vain yksi puu, mikä tahansa sadasta
linnut2<-linnut[[99]]
#define a variance-covariance structure based on the model of Brownian evolution
bm.birds=corBrownian(1,phy=linnut2)
#tehdään fylogenialistasta matriisi
lintupuu<-vcv.phylo(linnut2)
#matriisin voi värittää havainnollistamaan lintulajien sukulaisuutta
heatmap(lintupuu,Rowv = NA,Colv = NA)
#aineiston rivien nimet muutetaan lattareiksi jolloin keskustelee fylogeniapuun kanssa
rownames(results)=results$species
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pool_pa_change ~ 1, data = results,correlation=bm.birds,method="ML" )
malli1 <- gls(pool_pa_change ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(pool_pa_change ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(pool_pa_change ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(pool_pa_change ~ Prev, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(pool_pa_change ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(pool_pa_change ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(pool_pa_change ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(pool_pa_change ~ log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(pool_pa_change ~ Mig +Prev, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(pool_pa_change ~ Hab+Prev, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(pool_pa_change ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(pool_pa_change ~ Mig + Hab + Prev, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(pool_pa_change ~ Mig + Prev + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(pool_pa_change ~ Prev + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(pool_pa_change ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#malli #10 on paras mutta seuraava malli on 0.27 AICc yksikön päässä.
output2<-model.sel(malli0,malli3,malli8,malli4)
summary(model.avg(output2, revised.var = TRUE))
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pool_abu_change ~ 1, data = results,correlation=bm.birds,method="ML" )
malli0 <- gls(pool_abu_change ~ 1, data = results,correlation=bm.birds,method="ML" ,na.rm=T)
malli0 <- gls(pool_abu_change ~ 1, data = results,correlation=bm.birds,method="ML" ,na.action="na.exclude")
