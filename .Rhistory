ns=dim(mpred1)[2]
dim(mpred2)
dim(Y)
dim(studyDesign)
pm1p1=mpred1[period1,]
pm2p1=mpred2[period1,]
pm1p2=mpred1[period2,] #pm1p2 = predictions by model 1 to period 2
pm2p2=mpred2[period2,]
y1=Y[period1,]
y2=Y[period2,]
sd1 = studyDesign[period1,]
sd2 = studyDesign[period2,]
# COMPUTE MEASURES C AND D
selroutes = routes[which(ntypes==1)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (j in 1:ns){
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] & y1[,j]>-1)
take2 = which(sd2$Route == selroutes[i]& y2[,j]>-1)
Ap1[i,j] = mean(pm1p2[take2,j])-mean(pm1p1[take1,j]) #ka laskettava vain vuosilta, jolloin lajia on havaittu
Ay[i,j] = mean(y2[take2,j],na.rm=T)- mean(y1[take1,j],na.rm=T) #NA:t eiv?t saa est?? keskiarvon laskemista koko lajille.
}}
t1 = rep(NA,ns)
for (i in 1:ns){
t1[i] = cor(Ap1[,i],Ay[,i],use="na.or.complete")
}
plot(t1)+abline(0,0)
mean(t1,na.rm = TRUE)
# COMPUTE MEASURES C AND D
selroutes = routes[which(ntypes==3)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (j in 1:ns){
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] & y1[,j]>-1)
take2 = which(sd2$Route == selroutes[i]& y2[,j]>-1)
Ap1[i,j] = mean(pm1p2[take2,j])-mean(pm1p1[take1,j]) #ka laskettava vain vuosilta, jolloin lajia on havaittu
Ay[i,j] = mean(y2[take2,j],na.rm=T)- mean(y1[take1,j],na.rm=T) #NA:t eiv?t saa est?? keskiarvon laskemista koko lajille.
}}
t3 = rep(NA,ns)
for (i in 1:ns){
t3[i] = cor(Ap1[,i],Ay[,i],use="na.or.complete")
}
plot(t3)+abline(0,0)
mean(t3,na.rm = TRUE)
# COMPUTE MEASURES C AND D
selroutes = routes[which(ntypes==4)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (j in 1:ns){
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] & y1[,j]>-1)
take2 = which(sd2$Route == selroutes[i]& y2[,j]>-1)
Ap1[i,j] = mean(pm1p2[take2,j])-mean(pm1p1[take1,j]) #ka laskettava vain vuosilta, jolloin lajia on havaittu
Ay[i,j] = mean(y2[take2,j],na.rm=T)- mean(y1[take1,j],na.rm=T) #NA:t eiv?t saa est?? keskiarvon laskemista koko lajille.
}}
t4 = rep(NA,ns)
for (i in 1:ns){
t4[i] = cor(Ap1[,i],Ay[,i],use="na.or.complete")
}
plot(t4)+abline(0,0)
mean(t4,na.rm = TRUE)
#save results as datatable for further analysis
abu_ntype=data.frame(species,t1,t3,t4)
species=colnames(Y)
abu_ntype=data.frame(species,t1,t3,t4)
setnames(abu_ntype,c("t1","t3","t4"),c("abu_t1","abu_t3","abu_t4"))
write.csv(abu_ntype, "abu_ntype.csv",row.names = F)
nres=inner_join(pa_ntype,abu_ntype,by="species")
knitr::opts_chunk$set(echo = TRUE)
getwd()
paketit<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","sp","GISTools","rgdal","sf","spatialEco","ggplot2","ggrepel")
lapply(paketit,library,character.only=T)
getwd()
localDir = "."
PredictionDir = file.path(localDir, "data")
#model 1: data until 1999; model 2: full data
#mpred1: posterior mean based on model 1; mpred2: posterior mean based on model 2
samples = 1000
thin = 10
nChains = 4
modeltype = 1 #1 on pa-aineistolle
filename = file.path(PredictionDir, paste("predictions_",c("pa","abundance")[modeltype],
"_chains_",as.character(nChains),"_thin_", as.character(thin),"_samples_", as.character(samples),
".Rdata",sep = ""))
load(filename) #mpred1, mpred2, Y, studyDesign
routes=levels(studyDesign$Route)
nr=length(routes)
years=levels(studyDesign$Year)
dim(mpred1)
ns=dim(mpred1)[2]
dim(mpred2)
dim(Y)
dim(studyDesign)
period1=(studyDesign$Year=="Year_1996" | studyDesign$Year=="Year_1997" | studyDesign$Year=="Year_1998" | studyDesign$Year=="Year_1999")
period2=(studyDesign$Year=="Year_2013" | studyDesign$Year=="Year_2014" | studyDesign$Year=="Year_2015" | studyDesign$Year=="Year_2016")
pm1p1=mpred1[period1,]
pm2p1=mpred2[period1,]
pm1p2=mpred1[period2,] #pm1p2 = predictions by model 1 to period 2
pm2p2=mpred2[period2,]
y1=Y[period1,]
y2=Y[period2,]
sd1 = studyDesign[period1,]
sd2 = studyDesign[period2,]
visits1 = rep(NA,nr)
visits2 = rep(NA,nr)
for (i in 1:nr){
visits1[i] = sum(sd1$Route==routes[i])
visits2[i] = sum(sd2$Route==routes[i])
}
ntypes=rep(NA,nr)
ntypes[visits1==0 & visits2==0]=0
ntypes[visits1>=1 & visits2==0]=0
ntypes[visits1==0 & visits2>=1]=0
ntypes[visits1==1 & visits2==1]=1
ntypes[visits1==1 & visits2>1]=2
ntypes[visits1>1 & visits2==1]=2
ntypes[visits1==2 & visits2>1]=3
ntypes[visits1>1 & visits2==2]=3
ntypes[visits1>=3 & visits2>=3]=4
#tarkistetaan kuinka monta reittiä kussakin kategoriassa on
as.data.frame(table(ntypes))
#ntype 1
# COMPUTE MEASURES D
selroutes = routes[which(ntypes==1)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i])
take2 = which(sd2$Route == selroutes[i])
Ap1[i,] = pm1p2[take2,]-pm1p1[take1,] #huom! ei ColSums koska vain yksi arvo, josta lasketaan
Ay[i,] = y2[take2,]- y1[take1,]   #osassa NA:ta
}
t1 = rep(NA,ns)
for (i in 1:ns){
t1[i] = cor(Ap1[,i],Ay[,i], use="na.or.complete")
}
plot(t1) + abline(0,0)
mean(t1,na.rm = TRUE)
#ntype 3
# COMPUTE MEASURES D
selroutes = routes[which(ntypes==3)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i])
take2 = which(sd2$Route == selroutes[i])
Ap1[i,] = colMeans(pm1p2[take2,])-colMeans(pm1p1[take1,]) #ennusteisiin ei tule NA:ta mutta seuraavissa laskuissa havaintojen NA eliminoi ennusteissa olevat virheet
Ay[i,] = colMeans(y2[take2,])- colMeans(y1[take1,])   #Suomen vesilintujen NA:t s?ilyv?t
}
t3 = rep(NA,ns)
for (i in 1:ns){
t3[i] = cor(Ap1[,i],Ay[,i], use="na.or.complete")
}
plot(t3) + abline(0,0)
mean(t3,na.rm = TRUE)
#ntype 4
# COMPUTE MEASURES D
selroutes = routes[which(ntypes==4)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i])
take2 = which(sd2$Route == selroutes[i])
Ap1[i,] = colMeans(pm1p2[take2,])-colMeans(pm1p1[take1,]) #ennusteisiin ei tule NA:ta mutta seuraavissa laskuissa havaintojen NA eliminoi ennusteissa olevat virheet
Ay[i,] = colMeans(y2[take2,])- colMeans(y1[take1,])   #Suomen vesilintujen NA:t s?ilyv?t
}
t4 = rep(NA,ns)
for (i in 1:ns){
t4[i] = cor(Ap1[,i],Ay[,i], use="na.or.complete")
}
plot(t4) + abline(0,0)
mean(t4,na.rm = TRUE)
#save results as datatable for further analysis
species=colnames(Y)
pa_ntype=data.frame(species,t1,t3,t4)
setnames(pa_ntype,c("t1","t3","t4"),c("pa_t1","pa_t3","pa_t4"))
write.csv(pa_ntype, "pa_ntype.csv",row.names = F)
modeltype = 2 #2 on abu-aineistolle
filename = file.path(PredictionDir, paste("predictions_",c("pa","abundance")[modeltype],                                    "_chains_",as.character(nChains),"_thin_", as.character(thin),"_samples_", as.character(samples),".Rdata",sep = ""))
load(filename) #mpred1, mpred2, Y, studyDesign
routes=levels(studyDesign$Route)
nr=length(routes)
years=levels(studyDesign$Year)
dim(mpred1)
ns=dim(mpred1)[2]
dim(mpred2)
dim(Y)
dim(studyDesign)
pm1p1=mpred1[period1,]
pm2p1=mpred2[period1,]
pm1p2=mpred1[period2,] #pm1p2 = predictions by model 1 to period 2
pm2p2=mpred2[period2,]
y1=Y[period1,]
y2=Y[period2,]
sd1 = studyDesign[period1,]
sd2 = studyDesign[period2,]
# COMPUTE MEASURES C AND D
selroutes = routes[which(ntypes==1)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (j in 1:ns){
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] & y1[,j]>-1)
take2 = which(sd2$Route == selroutes[i]& y2[,j]>-1)
Ap1[i,j] = mean(pm1p2[take2,j])-mean(pm1p1[take1,j]) #ka laskettava vain vuosilta, jolloin lajia on havaittu
Ay[i,j] = mean(y2[take2,j],na.rm=T)- mean(y1[take1,j],na.rm=T) #NA:t eiv?t saa est?? keskiarvon laskemista koko lajille.
}}
t1 = rep(NA,ns)
for (i in 1:ns){
t1[i] = cor(Ap1[,i],Ay[,i],use="na.or.complete")
}
plot(t1)+abline(0,0)
mean(t1,na.rm = TRUE)
# COMPUTE MEASURES C AND D
selroutes = routes[which(ntypes==3)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (j in 1:ns){
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] & y1[,j]>-1)
take2 = which(sd2$Route == selroutes[i]& y2[,j]>-1)
Ap1[i,j] = mean(pm1p2[take2,j])-mean(pm1p1[take1,j]) #ka laskettava vain vuosilta, jolloin lajia on havaittu
Ay[i,j] = mean(y2[take2,j],na.rm=T)- mean(y1[take1,j],na.rm=T) #NA:t eiv?t saa est?? keskiarvon laskemista koko lajille.
}}
t3 = rep(NA,ns)
for (i in 1:ns){
t3[i] = cor(Ap1[,i],Ay[,i],use="na.or.complete")
}
plot(t3)+abline(0,0)
mean(t3,na.rm = TRUE)
# COMPUTE MEASURES C AND D
selroutes = routes[which(ntypes==4)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (j in 1:ns){
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] & y1[,j]>-1)
take2 = which(sd2$Route == selroutes[i]& y2[,j]>-1)
Ap1[i,j] = mean(pm1p2[take2,j])-mean(pm1p1[take1,j]) #ka laskettava vain vuosilta, jolloin lajia on havaittu
Ay[i,j] = mean(y2[take2,j],na.rm=T)- mean(y1[take1,j],na.rm=T) #NA:t eiv?t saa est?? keskiarvon laskemista koko lajille.
}}
t4 = rep(NA,ns)
for (i in 1:ns){
t4[i] = cor(Ap1[,i],Ay[,i],use="na.or.complete")
}
plot(t4)+abline(0,0)
mean(t4,na.rm = TRUE)
#save results as datatable for further analysis
species=colnames(Y)
abu_ntype=data.frame(species,t1,t3,t4)
setnames(abu_ntype,c("t1","t3","t4"),c("abu_t1","abu_t3","abu_t4"))
write.csv(abu_ntype, "abu_ntype.csv",row.names = F)
nres=inner_join(pa_ntype,abu_ntype,by="species")
##lasketaan kaikille arvoille keskiarvot ja se:t
nres %>% dplyr::select(2:7)%>%colMeans(,na.rm = T)
nres %>% dplyr::select(2:7)%>%std.error()
#muokataan aineistoa
nres2=gather(nres,"method","accuracy",2:7)
View(nres2)
nres2$method=as.factor(nres2$method)
()
#plottailua
p=ggplot(nres2,aes(x=method,y=accuracy))+geom_boxplot()
p
#plottailua
p=ggplot(nres2,aes(x=method,y=accuracy))+geom_boxplot()
p + scale_x_discrete(limits=c("pa_t1", "pa_t3","pa_t4"))
p+ scale_x_discrete(limits=c("abu_t1", "abu_t3","abu_t4"))
##lasketaan kaikille arvoille keskiarvot ja se:t
nres %>% dplyr::select(2:7)%>%colMeans(,na.rm = T)
p+ scale_x_discrete(limits=c("abu_t1", "abu_t3","abu_t4"))
#valitaan vain pa-aineisto
nres2_pa=(nres2$method=="pa_t1" | nres2$method == "pa_t3" | nres2$method == "pa_t4")
#valitaan vain pa-aineisto
nres2_pa=subset(nres2,nres2$method=="pa_t1" | nres2$method == "pa_t3" | nres2$method == "pa_t4")
View(nres2_pa)
#two-way anova
anova(lm(nres2_pa$accuracy~nres2_pa$method+nres2_pa$species))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(nres2_pa$accuracy, nres2_pa$method, p.adj="bonferroni")
#valitaan vain pa-aineisto
nres2_abu=subset(nres2,nres2$method=="abu_t1" | nres2$method == "abu_t3" | nres2$method == "abu_t4")
#two-way anova
anova(lm(nres2_abu$accuracy~nres2_abu$method+nres2_abu$species))
p=ggplot(nres2,aes(x=method,y=accuracy))+geom_boxplot()
p + scale_x_discrete(limits=c("pa_t1", "pa_t3","pa_t4"))
nres %>% dplyr::select(2:7)%>%std.error()
knitr::opts_chunk$set(echo = TRUE)
getwd()
paketit<-c("nlme","readr","tidyr","dplyr","plyr","magrittr","purrr","ggplot2","ape","geiger","MuMIn","psych","Hmisc")
lapply(paketit,library,character.only=T)
#yhdistetään ennustustarkkuustulokset ja lajiominaisuudet samaan taulukkoon
res<-read.csv("results_and_pooled.csv")
traits<-read.csv("traits_table.csv",sep = ";")
results<-inner_join(res,traits,by="species")
#tallenna tarvittaessa omaksi taulukokseen
#write.csv(res,"accuracies_traits.csv",row.names = F)
#kuvaajien piirtely ei (ainakaan multa) onnistu jos log(Mass) ei ole valmiiksi laskettu omaan
#sarakkeeseensa
results$logmass<-log(results$Mass)
#pa aineisto
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pa_D~Hab,data=results,ylab="pa_D",xlab="Habitat")
plot(pa_D~Prev, data = results,ylab="pa_D",xlab="Prevalence")
abline(lm(pa_D~Prev,data = results))
boxplot(pa_D~Mig,data=results,ylab="pa_D",xlab="Migration")
plot(pa_D~logmass, data = results,ylab="pa_D",xlab="log(Mass)")
abline(lm(pa_D~logmass,data = results))
par(op)
#abu aineisto
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(abu_D~Hab,data=results,ylab="abu_D",xlab="Habitat")
plot(abu_D~Prev, data = results,ylab="abu_D",xlab="Prevalence")
abline(lm(abu_D~Prev,data = results))
boxplot(abu_D~Mig,data=results,ylab="abu_D",xlab="Migration")
plot(abu_D~logmass, data = results,ylab="abu_D",xlab="log(Mass)")
abline(lm(abu_D~logmass,data = results))
par(op)
#poolattu pa aineisto
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pool_pa_change~Hab,data=results,ylab="pool_pa_D",xlab="Habitat")
plot(pool_pa_change~Prev, data = results,ylab="pool_pa_D",xlab="Prevalence")
abline(lm(pool_pa_change~Prev,data = results))
boxplot(pool_pa_change~Mig,data=results,ylab="pool_pa_D",xlab="Migration")
plot(pool_pa_change~logmass, data = results,ylab="pool_pa_D",xlab="log(Mass)")
abline(lm(pool_pa_change~logmass,data = results))
par(op)
#poolattu abu aineisto
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pool_abu_change~Hab,data=results,ylab="pool_abu_D",xlab="Habitat")
plot(pool_abu_change~Prev, data = results,ylab="pool_abu_D",xlab="Prevalence")
abline(lm(pool_abu_change~Prev,data = results))
boxplot(pool_abu_change~Mig,data=results,ylab="pool_abu_D",xlab="Migration")
plot(pool_abu_change~logmass, data = results,ylab="pool_abu_D",xlab="log(Mass)")
abline(lm(pool_abu_change~logmass,data = results))
par(op)
#luetaan aineisto sisään, Multiphylo eli monta puuta
linnut <- read.nexus("output.nex")
#valitaan vain yksi puu, mikä tahansa sadasta
linnut2<-linnut[[99]]
#define a variance-covariance structure based on the model of Brownian evolution
bm.birds=corBrownian(1,phy=linnut2)
#tehdään fylogenialistasta matriisi
lintupuu<-vcv.phylo(linnut2)
#matriisin voi värittää havainnollistamaan lintulajien sukulaisuutta
heatmap(lintupuu,Rowv = NA,Colv = NA)
#aineiston rivien nimet muutetaan lattareiksi jolloin keskustelee fylogeniapuun kanssa
rownames(results)=results$species
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pa_D ~ 1, data = results)
malli1 <- gls(pa_D ~ Mig, data = results)
malli2 <- gls(pa_D ~ Hab, data = results)
malli3 <- gls(pa_D ~ log(Mass), data = results)
malli4 <- gls(pa_D ~ Prev, data = results)
malli5 <- gls(pa_D ~ Mig + Hab, data = results)
malli6 <- gls(pa_D ~ Hab + log(Mass), data = results)
malli7 <- gls(pa_D ~ Mig + log(Mass), data = results)
malli8 <- gls(pa_D ~ log(Mass)+Prev, data = results)
malli9 <- gls(pa_D ~ Mig +Prev, data = results)
malli10 <- gls(pa_D ~ Hab+Prev, data = results)
malli11 <- gls(pa_D ~ Mig + Hab + log(Mass), data = results)
malli12 <- gls(pa_D ~ Mig + Hab + Prev, data = results)
malli13 <- gls(pa_D ~ Mig + Prev + log(Mass), data = results)
malli14 <- gls(pa_D ~ Prev + Hab + log(Mass), data = results)
malli15 <- gls(pa_D ~ Mig + Hab + log(Mass)+Prev, data = results)
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
# Parameter estimate Table, katsotaan tarkemmin parasta mallia
summary(malli0)
#sama fylogenia huomioiden
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pa_D ~ 1, data = results,correlation=bm.birds,method="ML" )
malli1 <- gls(pa_D ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(pa_D ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(pa_D ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(pa_D ~ Prev, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(pa_D ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(pa_D ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(pa_D ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(pa_D ~ log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(pa_D ~ Mig +Prev, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(pa_D ~ Hab+Prev, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(pa_D ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(pa_D ~ Mig + Hab + Prev, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(pa_D ~ Mig + Prev + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(pa_D ~ Prev + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(pa_D ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#tehdään model averaging
summary(model.avg(output1, revised.var = TRUE))
# Parameter estimate Table, katsotaan tarkemmin parasta mallia
summary(malli3)
#luodaan eri mallivaihtoehtoja
malli0 <- gls(abu_D ~ 1, data = results)
malli1 <- gls(abu_D ~ Mig, data = results)
malli2 <- gls(abu_D ~ Hab, data = results)
malli3 <- gls(abu_D ~ log(Mass), data = results)
malli4 <- gls(abu_D ~ Prev, data = results)
malli5 <- gls(abu_D ~ Mig + Hab, data = results)
malli6 <- gls(abu_D ~ Hab + log(Mass), data = results)
malli7 <- gls(abu_D ~ Mig + log(Mass), data = results)
malli8 <- gls(abu_D ~ log(Mass)+Prev, data = results)
malli9 <- gls(abu_D ~ Mig +Prev, data = results)
malli10 <- gls(abu_D ~ Hab+Prev, data = results)
malli11 <- gls(abu_D ~ Mig + Hab + log(Mass), data = results)
malli12 <- gls(abu_D ~ Mig + Hab + Prev, data = results)
malli13 <- gls(abu_D ~ Mig + Prev + log(Mass), data = results)
malli14 <- gls(abu_D ~ Prev + Hab + log(Mass), data = results)
malli15 <- gls(abu_D ~ Mig + Hab + log(Mass)+Prev, data = results)
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
# Parameter estimate Table, katsotaan tarkemmin parasta mallia
summary(malli0)
#mikään muuttuja ei ole merkitsevä.
#sama fylogenia huomioiden
#luodaan eri mallivaihtoehtoja
malli0 <- gls(abu_D ~ 1, data = results,correlation=bm.birds,method="ML" )
malli1 <- gls(abu_D ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(abu_D ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(abu_D ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(abu_D ~ Prev, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(abu_D ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(abu_D ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(abu_D ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(abu_D ~ log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(abu_D ~ Mig +Prev, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(abu_D ~ Hab+Prev, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(abu_D ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(abu_D ~ Mig + Hab + Prev, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(abu_D ~ Mig + Prev + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(abu_D ~ Prev + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(abu_D ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#tehdään model averaging
summary(model.avg(output1, revised.var = TRUE))
#tässä mikään muuttuja ei ole merkitsevä?
# Parameter estimate Table, katsotaan tarkemmin parasta mallia
summary(malli9)
summary(malli13)
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pool_pa_change ~ 1, data = results)
malli1 <- gls(pool_pa_change ~ Mig, data = results)
malli2 <- gls(pool_pa_change ~ Hab, data = results)
malli3 <- gls(pool_pa_change ~ log(Mass), data = results)
malli4 <- gls(pool_pa_change ~ Prev, data = results)
malli5 <- gls(pool_pa_change ~ Mig + Hab, data = results)
malli6 <- gls(pool_pa_change ~ Hab + log(Mass), data = results)
malli7 <- gls(pool_pa_change ~ Mig + log(Mass), data = results)
malli8 <- gls(pool_pa_change ~ log(Mass)+Prev, data = results)
malli9 <- gls(pool_pa_change ~ Mig +Prev, data = results)
malli10 <- gls(pool_pa_change ~ Hab+Prev, data = results)
malli11 <- gls(pool_pa_change ~ Mig + Hab + log(Mass), data = results)
malli12 <- gls(pool_pa_change ~ Mig + Hab + Prev, data = results)
malli13 <- gls(pool_pa_change ~ Mig + Prev + log(Mass), data = results)
malli14 <- gls(pool_pa_change ~ Prev + Hab + log(Mass), data = results)
malli15 <- gls(pool_pa_change ~ Mig + Hab + log(Mass)+Prev, data = results)
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#tehdään model averaging
summary(model.avg(output1, revised.var = TRUE))
# Parameter estimate Table, katsotaan tarkemmin parasta mallia
summary(malli0)
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pool_pa_change ~ 1, data = results,correlation=bm.birds,method="ML" )
malli1 <- gls(pool_pa_change ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(pool_pa_change ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(pool_pa_change ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(pool_pa_change ~ Prev, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(pool_pa_change ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(pool_pa_change ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(pool_pa_change ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(pool_pa_change ~ log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(pool_pa_change ~ Mig +Prev, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(pool_pa_change ~ Hab+Prev, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(pool_pa_change ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(pool_pa_change ~ Mig + Hab + Prev, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(pool_pa_change ~ Mig + Prev + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(pool_pa_change ~ Prev + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(pool_pa_change ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#malli #10 on paras mutta seuraava malli on 0.27 AICc yksikön päässä.
#tehdään model averaging
summary(model.avg(output1, revised.var = TRUE))
# Parameter estimate Table, katsotaan tarkemmin parasta mallia
summary(malli0)
summary(malli3)
