dim(Y)
dim(studyDesign)
period1=(studyDesign$Year=="Year_1996" | studyDesign$Year=="Year_1997" | studyDesign$Year=="Year_1998" | studyDesign$Year=="Year_1999")
period2=(studyDesign$Year=="Year_2013" | studyDesign$Year=="Year_2014" | studyDesign$Year=="Year_2015" | studyDesign$Year=="Year_2016")
pm1p1=mpred1[period1,]
pm1p2=mpred1[period2,] #pm1p2 = predictions by model 1 to period 2
y1=Y[period1,]
y2=Y[period2,]
sd1 = studyDesign[period1,]
sd2 = studyDesign[period2,]
visits1 = rep(NA,nr)
visits2 = rep(NA,nr)
for (i in 1:nr){
visits1[i] = sum(sd1$Route==routes[i])
visits2[i] = sum(sd2$Route==routes[i])
}
selroutes = routes[which(visits1>=2 & visits2>=2)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ap2=matrix(NA,nrow = nsr,ncol = ns)
Ay2=matrix(NA,nrow = nsr,ncol = ns)
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] )
take2 = which(sd2$Route == selroutes[i] )
Ap1[i,] = colMeans(pm1p1[take1,])
Ap2[i,] = colMeans(pm1p2[take2,])
Ay1[i,] = colMeans(y1[take1,]) #Suomen vesilintujen NA:t vain NA:ta
Ay2[i,] = colMeans(y2[take2,])
}
Ay1=matrix(NA,nrow = nsr,ncol = ns)
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] )
take2 = which(sd2$Route == selroutes[i] )
Ap1[i,] = colMeans(pm1p1[take1,])
Ap2[i,] = colMeans(pm1p2[take2,])
Ay1[i,] = colMeans(y1[take1,]) #Suomen vesilintujen NA:t vain NA:ta
Ay2[i,] = colMeans(y2[take2,])
}
summary(Ay1)
routeyear<-read.csv("studydesign.csv",header=T,sep=",")
xy<-read.csv("xy.csv",header=T,sep=",")
xy<-xy%>%
mutate(x = x * 1000) %>%
mutate(y = y * 1000)
Route<-unique(routeyear$Route)
routeid<-c(1:2591)
d<-data.frame(Route,routeid)
Ap1=as.data.frame(Ap1)
Ap1=cbind(selroutes,Ap1)
setnames(Ap1,"selroutes","Route")
Ap2=as.data.frame(Ap2)
Ap2=cbind(selroutes,Ap2)
setnames(Ap2,"selroutes","Route")
Ay1=cbind(selroutes,Ay1)
setnames(Ay1,"selroutes","Route")
Ay2=as.data.frame(Ay2)
Ay1=as.data.frame(Ay1)
Ay1=cbind(selroutes,Ay1)
setnames(Ay1,"selroutes","Route")
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ap2=matrix(NA,nrow = nsr,ncol = ns)
Ay1=matrix(NA,nrow = nsr,ncol = ns)
Ay2=matrix(NA,nrow = nsr,ncol = ns)
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] )
take2 = which(sd2$Route == selroutes[i] )
Ap1[i,] = colMeans(pm1p1[take1,])
Ap2[i,] = colMeans(pm1p2[take2,])
Ay1[i,] = colMeans(y1[take1,]) #Suomen vesilintujen NA:t vain NA:ta
Ay2[i,] = colMeans(y2[take2,])
}
routeyear<-read.csv("studydesign.csv",header=T,sep=",")
xy<-read.csv("xy.csv",header=T,sep=",")
#koordinaateista puuttuu nollia
xy<-xy%>%
mutate(x = x * 1000) %>%
mutate(y = y * 1000)
#jotta koordinaatit saa liitetty? oikealle linjalle, tehdään taulukko, jossa reiteillä on molemmat koodaukset (alkuperäiset ja 1-2591)
Route<-unique(routeyear$Route)
routeid<-c(1:2591)
d<-data.frame(Route,routeid)
#matriisit on muutettava dataframeiksi
Ap1=as.data.frame(Ap1)
Ap1=cbind(selroutes,Ap1)
setnames(Ap1,"selroutes","Route")
Ap2=as.data.frame(Ap2)
Ap2=cbind(selroutes,Ap2)
setnames(Ap2,"selroutes","Route")
Ay1=as.data.frame(Ay1)
Ay1=cbind(selroutes,Ay1)
setnames(Ay1,"selroutes","Route")
Ay2=as.data.frame(Ay2)
Ay2=cbind(selroutes,Ay2)
setnames(Ay2,"selroutes","Route")
Ap1<-left_join(Ap1,d,by="Route")
Ap2<-left_join(Ap2,d,by="Route")
Ay1<-left_join(Ay1,d,by="Route")
Ay2<-left_join(Ay2,d,by="Route")
#...ja vihdoin myös koordinaatit
Ap1<-left_join(Ap1,xy,by=c("routeid"="route"))
Ap2<-left_join(Ap2,xy,by=c("routeid"="route"))
Ay1<-left_join(Ay1,xy,by=c("routeid"="route"))
Ay2<-left_join(Ay2,xy,by=c("routeid"="route"))
View(Ap1)
coordinates(Ay1)<-c("x","y")
plot(Ay1)
proj4string(Ay1) <-CRS("+init=EPSG:3035")
coordinates(Ay2)<-c("x","y")
plot(Ay2)
coordinates(Ap1)<-c("x","y")
plot(Ap1)
proj4string(Ap1) <-CRS("+init=EPSG:3035")
coordinates(Ap2)<-c("x","y")
plot(Ap2)
proj4string(Ap2) <-CRS("+init=EPSG:3035")
gridi<- readOGR(dsn="./gridit", layer="grid500km")
gridi<- readOGR(dsn="./gridit", layer="grid50km")
proj4string(gridi)
plot(gridi)
pts.poly <- point.in.poly(Ay1, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>% #jos jollain lajilla on yhdell? linjalla NA:ta se ei vaikuta keskiarvon laskemiseen.
write.csv(.,file = "pool_pa_obs_per1.csv",row.names=F)
pts.poly <- point.in.poly(Ay2, gridi)
pts.poly <- point.in.poly(Ay2, gridi)
coordinates(Ay2)<-c("x","y")
plot(Ay2)
pts.poly <- point.in.poly(Ay2, gridi)
pts.poly <- point.in.poly(Ap1, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_pa_pred_per1.csv",row.names=F)
pts.poly <- point.in.poly(Ap2, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_pa_pred_per2.csv",row.names=F)
#liiteään kuhunkin linjaan tieto, millä gridin ruudulla se on
pts.poly <- point.in.poly(Ay1, gridi)
data<-as.data.frame(pts.poly)
#ryhmitell??n linjat gridiruuduittain ja lasketaan keskiarvot kullekin sarakkeelle, eli lajeittain.
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>% #jos jollain lajilla on yhdell? linjalla NA:ta se ei vaikuta keskiarvon laskemiseen.
write.csv(.,file = "pool_pa_obs_per1.csv",row.names=F)
pts.poly <- point.in.poly(Ay2, gridi)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ap2=matrix(NA,nrow = nsr,ncol = ns)
Ay1=matrix(NA,nrow = nsr,ncol = ns)
Ay2=matrix(NA,nrow = nsr,ncol = ns)
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] )
take2 = which(sd2$Route == selroutes[i] )
Ap1[i,] = colMeans(pm1p1[take1,])
Ap2[i,] = colMeans(pm1p2[take2,])
Ay1[i,] = colMeans(y1[take1,]) #Suomen vesilinnut vain NA:ta
Ay2[i,] = colMeans(y2[take2,])
}
routeyear<-read.csv("studydesign.csv",header=T,sep=",")
xy<-read.csv("xy.csv",header=T,sep=",")
#koordinaateista puuttuu nollia
xy<-xy%>%
mutate(x = x * 1000) %>%
mutate(y = y * 1000)
#jotta koordinaatit saa liitetty? oikealle linjalle, tehdään taulukko, jossa reiteillä on molemmat koodaukset (alkuperäiset ja 1-2591)
Route<-unique(routeyear$Route)
routeid<-c(1:2591)
d<-data.frame(Route,routeid)
#matriisit on muutettava dataframeiksi
Ap1=as.data.frame(Ap1)
Ap1=cbind(selroutes,Ap1)
setnames(Ap1,"selroutes","Route")
Ap2=as.data.frame(Ap2)
Ap2=cbind(selroutes,Ap2)
setnames(Ap2,"selroutes","Route")
Ay1=as.data.frame(Ay1)
Ay1=cbind(selroutes,Ay1)
setnames(Ay1,"selroutes","Route")
Ay2=as.data.frame(Ay2)
Ay2=cbind(selroutes,Ay2)
setnames(Ay2,"selroutes","Route")
#lisätään havaintoihin ja ennusteisiin ensin oikeat reittikoodit (1-2591)
Ap1<-left_join(Ap1,d,by="Route")
Ap2<-left_join(Ap2,d,by="Route")
Ay1<-left_join(Ay1,d,by="Route")
Ay2<-left_join(Ay2,d,by="Route")
#...ja vihdoin myös koordinaatit
Ap1<-left_join(Ap1,xy,by=c("routeid"="route"))
Ap2<-left_join(Ap2,xy,by=c("routeid"="route"))
Ay1<-left_join(Ay1,xy,by=c("routeid"="route"))
Ay2<-left_join(Ay2,xy,by=c("routeid"="route"))
write.csv(Ay1,"pa_obs_per1.csv",row.names = F)
write.csv(Ay2,"pa_obs_per2.csv",row.names = F)
write.csv(Ap1,"pa_pred_per1.csv",row.names = F)
write.csv(Ap2,"pa_pred_per2.csv",row.names = F)
coordinates(Ay1)<-c("x","y")
plot(Ay1)
proj4string(Ay1) <-CRS("+init=EPSG:3035")
coordinates(Ay2)<-c("x","y")
plot(Ay2)
proj4string(Ay2) <-CRS("+init=EPSG:3035")
coordinates(Ap1)<-c("x","y")
plot(Ap1)
proj4string(Ap1) <-CRS("+init=EPSG:3035")
coordinates(Ap2)<-c("x","y")
plot(Ap2)
proj4string(Ap2) <-CRS("+init=EPSG:3035")
gridi<- readOGR(dsn="./gridit", layer="grid50km")
#gridi<- readOGR(dsn="./gridit", layer="grid100km")
proj4string(gridi)
pts.poly <- point.in.poly(Ay1, gridi)
data<-as.data.frame(pts.poly)
#ryhmitell??n linjat gridiruuduittain ja lasketaan keskiarvot kullekin sarakkeelle, eli lajeittain.
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>% #jos jollain lajilla on yhdell? linjalla NA:ta se ei vaikuta keskiarvon laskemiseen.
write.csv(.,file = "pool_pa_obs_per1.csv",row.names=F)
#ja sama muille aineistoille
pts.poly <- point.in.poly(Ay2, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_pa_obs_per2.csv",row.names=F)
pts.poly <- point.in.poly(Ap1, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_pa_pred_per1.csv",row.names=F)
pts.poly <- point.in.poly(Ap2, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_pa_pred_per2.csv",row.names=F)
paY1<-read.csv("pool_pa_obs_per1.csv",header=T,sep=",")
paY2<-read.csv("pool_pa_obs_per2.csv",header=T,sep=",")
papred1<-read.csv("pool_pa_pred_per1.csv",header=T,sep=",")
papred2<-read.csv("pool_pa_pred_per2.csv",header=T,sep=",")
names(paY1)
drops <- c("routeid","left","top","right","bottom","coords.x1","coords.x2")
paY1<-paY1[ , !(names(paY1) %in% drops)]
paY2<-paY2[ , !(names(paY2) %in% drops)]
papred1<-papred1[ , !(names(papred1) %in% drops)]
papred2<-papred2[ , !(names(papred2) %in% drops)]
a<-colnames(Y)
b<-"grid_id"
a<-c(b,a)
names(paY1)<-a
names(papred1)<-a
names(papred2)<-a
pacounts_gather<-gather(paY1,key="Yspecies",value="Yper1",Acrocephalus_palustris:Vanellus_vanellus)
pacounts_gather2<-gather(paY2,key="Yspecies",value="Yper2",Acrocephalus_palustris:Vanellus_vanellus)
paY1<-read.csv("pool_pa_obs_per1.csv",header=T,sep=",")
paY2<-read.csv("pool_pa_obs_per2.csv",header=T,sep=",")
papred1<-read.csv("pool_pa_pred_per1.csv",header=T,sep=",")
papred2<-read.csv("pool_pa_pred_per2.csv",header=T,sep=",")
#heivataan turhat sarakkeet
names(paY1)
drops <- c("routeid","left","top","right","bottom","coords.x1","coords.x2")
paY1<-paY1[ , !(names(paY1) %in% drops)]
paY2<-paY2[ , !(names(paY2) %in% drops)]
papred1<-papred1[ , !(names(papred1) %in% drops)]
papred2<-papred2[ , !(names(papred2) %in% drops)]
#korjataan sarakkeiden lajinimet kunnollisiksi
a<-colnames(Y)
b<-"grid_id"
a<-c(b,a)
names(paY1)<-a
names(paY2)<-a
names(papred1)<-a
names(papred2)<-a
pacounts_gather<-gather(paY1,key="Yspecies",value="Yper1",Acrocephalus_palustris:Vanellus_vanellus)
pacounts_gather2<-gather(paY2,key="Yspecies",value="Yper2",Acrocephalus_palustris:Vanellus_vanellus)
payhd<-left_join(pacounts_gather,pacounts_gather2,by=c("grid_id"="grid_id","Yspecies"="Yspecies"))
payhd$difY<-payhd$Yper2-payhd$Yper1
#pred
papred_gather<-gather(papred1,key="Pspecies",value="Pper1",Acrocephalus_palustris:Vanellus_vanellus)
papred_gather2<-gather(papred2,key="Pspecies",value="Pper2",Acrocephalus_palustris:Vanellus_vanellus)
payhdPred<-left_join(papred_gather,papred_gather2,by=c("grid_id"="grid_id","Pspecies"="Pspecies"))
payhdPred$difPred<-payhdPred$Pper2-payhdPred$Pper1
#yhdistetään tulokset, havainnot ja ennusteet samaan dataframeen
paKor<-left_join(payhd,payhdPred,by=c("grid_id"="grid_id","Yspecies"="Pspecies"))
keep<-c("Yspecies","difPred","difY")
paKor<-paKor[,keep,drop=F]
paKor %>%
group_by(Yspecies) %>%
dplyr::summarise(pool_pa_change= cor(difPred, difY, use= "na.or.complete"))%T>%
write.csv('pa_pool50_results.csv',row.names=F)
modeltype = 2 #2 on abu-aineistolle
filename = file.path(PredictionDir, paste("predictions_",c("pa","abundance")[modeltype],
"_chains_",as.character(nChains),"_thin_", as.character(thin),"_samples_", as.character(samples),
".Rdata",sep = ""))
load(filename) #mpred1, mpred2, Y, studyDesign
load(filename) #mpred1, mpred2, Y, studyDesign
routes=levels(studyDesign$Route)
years=levels(studyDesign$Year)
dim(mpred1)
ns=dim(mpred1)[2]
dim(mpred2)
dim(Y)
dim(studyDesign)
period1=(studyDesign$Year=="Year_1996" | studyDesign$Year=="Year_1997" | studyDesign$Year=="Year_1998" | studyDesign$Year=="Year_1999")
period2=(studyDesign$Year=="Year_2013" | studyDesign$Year=="Year_2014" | studyDesign$Year=="Year_2015" | studyDesign$Year=="Year_2016")
pm1p1=mpred1[period1,]
pm1p2=mpred1[period2,] #pm1p2 = predictions by model 1 to period 2
y1=Y[period1,]
y2=Y[period2,]
sd1 = studyDesign[period1,]
sd2 = studyDesign[period2,]
visits1 = rep(NA,nr)
visits2 = rep(NA,nr)
for (i in 1:nr){
visits1[i] = sum(sd1$Route==routes[i])
visits2[i] = sum(sd2$Route==routes[i])
}
selroutes = routes[which(visits1>=2 & visits2>=2)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ap2=matrix(NA,nrow = nsr,ncol = ns)
Ay1=matrix(NA,nrow = nsr,ncol = ns)
Ay2=matrix(NA,nrow = nsr,ncol = ns)
for(j in 1:ns){
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] & y1[,j]>-1)
take2 = which(sd2$Route == selroutes[i] & y2[,j]>-1)
Ap1[i,j] = mean(pm1p1[take1,j]) #ei laske ennusteille keskiarvoa niilt? linjoilta, jotka ovat havainnoissa NA
Ap2[i,j] = mean(pm1p2[take2,j])
Ay1[i,j] = mean(y1[take1,j], na.rm=T) #NA:t j?tet??n huomiotta keskiarvoa laskettaessa
Ay2[i,j] = mean(y2[take2,j], na.rm=T)
}}
Ap1=as.data.frame(Ap1)
Ap1=cbind(selroutes,Ap1)
setnames(Ap1,"selroutes","Route")
Ap2=as.data.frame(Ap2)
Ap2=cbind(selroutes,Ap2)
setnames(Ap2,"selroutes","Route")
Ay1=as.data.frame(Ay1)
Ay1=cbind(selroutes,Ay1)
setnames(Ay1,"selroutes","Route")
Ay2=as.data.frame(Ay2)
Ay2=cbind(selroutes,Ay2)
setnames(Ay2,"selroutes","Route")
Ap1<-left_join(Ap1,d,by="Route")
Ap2<-left_join(Ap2,d,by="Route")
Ay1<-left_join(Ay1,d,by="Route")
Ay2<-left_join(Ay2,d,by="Route")
#...ja koordinaatit
Ap1<-left_join(Ap1,xy,by=c("routeid"="route"))
Ap2<-left_join(Ap2,xy,by=c("routeid"="route"))
Ay1<-left_join(Ay1,xy,by=c("routeid"="route"))
Ay2<-left_join(Ay2,xy,by=c("routeid"="route"))
#save observations and predictions for pooling in GIS
write.csv(Ay1,"abu_obs_per1.csv",row.names = F)
write.csv(Ay2,"abu_obs_per2.csv",row.names = F)
write.csv(Ap1,"abu_pred_per1.csv",row.names = F)
write.csv(Ap2,"abu_pred_per2.csv",row.names = F)
coordinates(Ay1)<-c("x","y")
plot(Ay1)
proj4string(Ay1) <-CRS("+init=EPSG:3035")
coordinates(Ay2)<-c("x","y")
plot(Ay2)
proj4string(Ay2) <-CRS("+init=EPSG:3035")
coordinates(Ap1)<-c("x","y")
plot(Ap1)
proj4string(Ap1) <-CRS("+init=EPSG:3035")
coordinates(Ap2)<-c("x","y")
plot(Ap2)
proj4string(Ap2) <-CRS("+init=EPSG:3035")
pts.poly <- point.in.poly(Ay1, gridi)
data<-as.data.frame(pts.poly)
View(data)
names(data)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>% #NA:t eivät vaikuta laskuihin
write.csv(.,file = "pool_abu_obs_per1.csv",row.names=F,na="")
pts.poly <- point.in.poly(Ay2, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_abu_obs_per2.csv",row.names=F,na="")
pts.poly <- point.in.poly(Ap1, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_abu_pred_per1.csv",row.names=F,na="")
pts.poly <- point.in.poly(Ap2, gridi)
data<-as.data.frame(pts.poly)
data%>%
group_by(grid_id) %>%
summarise_at(vars(-Route), list(~mean(., na.rm=T))) %>%
write.csv(.,file = "pool_abu_pred_per2.csv",row.names=F,na="")
paY1<-read.csv("pool_abu_obs_per1.csv",header=T,sep=",")
paY2<-read.csv("pool_abu_obs_per2.csv",header=T,sep=",")
papred1<-read.csv("pool_abu_pred_per1.csv",header=T,sep=",")
papred2<-read.csv("pool_abu_pred_per2.csv",header=T,sep=",")
#heivataan turhat sarakkeet
names(paY1)
drops <- c("routeid","left","top","right","bottom","coords.x1","coords.x2")
paY1<-paY1[ , !(names(paY1) %in% drops)]
paY2<-paY2[ , !(names(paY2) %in% drops)]
papred1<-papred1[ , !(names(papred1) %in% drops)]
papred2<-papred2[ , !(names(papred2) %in% drops)]
#korjataan sarakkeiden lajinimet kunnollisiksi
a<-colnames(Y)
b<-"grid_id"
a<-c(b,a)
names(paY1)<-a
names(paY2)<-a
names(papred1)<-a
names(papred2)<-a
pacounts_gather<-gather(paY1,key="Yspecies",value="Yper1",Acrocephalus_palustris:Vanellus_vanellus)
pacounts_gather2<-gather(paY2,key="Yspecies",value="Yper2",Acrocephalus_palustris:Vanellus_vanellus)
payhd<-left_join(pacounts_gather,pacounts_gather2,by=c("grid_id"="grid_id","Yspecies"="Yspecies"))
payhd$difY<-payhd$Yper2-payhd$Yper1
#pred
papred_gather<-gather(papred1,key="Pspecies",value="Pper1",Acrocephalus_palustris:Vanellus_vanellus)
papred_gather2<-gather(papred2,key="Pspecies",value="Pper2",Acrocephalus_palustris:Vanellus_vanellus)
payhdPred<-left_join(papred_gather,papred_gather2,by=c("grid_id"="grid_id","Pspecies"="Pspecies"))
payhdPred$difPred<-payhdPred$Pper2-payhdPred$Pper1
#pa
abuKor<-left_join(payhd,payhdPred,by=c("grid_id"="grid_id","Yspecies"="Pspecies"))
keep<-c("Yspecies","difPred","difY")
abuKor<-abuKor[,keep,drop=F]
abuKor %>%
group_by(Yspecies) %>%
dplyr::summarise(pool_abu_change= cor(difPred, difY, use= "na.or.complete"))%T>%
write.csv('abu_pool50_results.csv',row.names=F)
res<-read.csv("results.csv")
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
pool_res<-inner_join(pool_pa,pool_abu,by="Yspecies")
res2<-inner_join(res,pool_res,by=c("species"="Yspecies"))
write.csv(res2,"results_and_pooled.csv",row.names = F)
res2 %>% dplyr::select(2:11)%>%colMeans()
res2 %>% dplyr::select(2:11)%>%std.error()
t.test(res2$pool_pa_change,res2$pa_D, paired = T)
plot(res2$pa_D,res2$pool_pa_change)
boxplot(res2$pa_D,res2$pool_pa_change)
res3=gather(res2,"method","accuracy",2:11)
View(res3)
p=ggplot(res3,aes(x=method,y=accuracy))+geom_boxplot()
paketit<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","sp","GISTools","rgdal","sf","spatialEco","ggplot")
lapply(paketit,library,character.only=T)
paketit<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","sp","GISTools","rgdal","sf","spatialEco","ggplot2")
lapply(paketit,library,character.only=T)
p=ggplot(res3,aes(x=method,y=accuracy))+geom_boxplot()
p
res3=res3[c(1,2,3,4,5,10,6,7,8,9,11)]
res3=res2[c(1,2,3,4,5,10,6,7,8,9,11)]
res3=gather(res3,"method","accuracy",2:11)
p=ggplot(res3,aes(x=method,y=accuracy))+geom_boxplot()
p
res3$¼method
res3$method
p + scale_x_discrete(limits=c("pa_A", "pa_B","pa_C","pa_D","pool_pa_change"))
p+ scale_x_discrete(limits=c("abu_A", "abu_B","abu_C","abu_D","pool_abu_change"))
p + scale_x_discrete(limits=c("pa_A", "pa_B","pa_C","pa_D","pool_pa_change"))
res2 %>% dplyr::select(2:11)%>%colMeans()
t.test(res2$pool_pa_change,res2$pa_D, paired = T)
anova(lm(res3$accuracy~res3$species+res3$method))
res4=res3[which (res3$method==c("pa_d","pool_pa_change"))]
res4=res3[which (res3$method==c("pa_D","pool_pa_change"))]
res4=res3[which (res3$method=="pool_pa_change")]
res4=res3[which (res3$method=='pool_pa_change')]
res3=as.factor(res3$method)
res3=res2[c(1,2,3,4,5,10,6,7,8,9,11)]
res3=gather(res3,"method","accuracy",2:11)
as.factor(res3$method)
mutate_at(res3,method,funs(as.factor())
#plottailua
p=ggplot(res3,aes(x=method,y=accuracy))+geom_boxplot()
mutate_at(res3,method,funs(as.factor())
#plottailua
p=ggplot(res3,aes(x=method,y=accuracy))+geom_boxplot()
res3 %>% mutate_at(.,method,funs(as.factor()))
res3 %>% mutate_at(.,vars(method),funs(as.factor()))
res3 %>% mutate_at(.,vars(method),list(~as.factor()))
res3 %>% mutate_at(.,vars("method"),list(~as.factor()))
res3 %>% mutate_at("method",list(~as.factor()))
res3 %>% mutate_at("method",as.factor())
res3$method=as.factor(res3$method)
p=ggplot(res3,aes(x=method,y=accuracy))+geom_boxplot()
p + scale_x_discrete(limits=c("pa_A", "pa_B","pa_C","pa_D","pool_pa_change"))
p+ scale_x_discrete(limits=c("abu_A", "abu_B","abu_C","abu_D","pool_abu_change"))
res4=res3[which (res3$method=='pool_pa_change')]
levels(res34method)
levels(res3$method)
res4=subset(res3,method=="pool_pa_change")
View(res4)
res4=subset(res3,method==c("pool_pa_change","pa_D")
anova(lm(res3$accuracy~res3$species+res3$method))
res4=subset(res3,method==c("pool_pa_change","pa_D"))
res4=subset(res3,method=="pool_pa_change"|method=="pa_D"))
res4=subset(res3,method=="pool_pa_change"|method=="pa_D")
View(res4)
summary(res4)
anova(lm(res4$accuracy~res4$species+res4$method))
res4=subset(res3,method=="pool_abu_change"|method=="abu_D")
anova(lm(res4$accuracy~res4$species+res4$method))
t.test(res2$pool_pa_change,res2$pa_D, paired = T)
t.test(res2$pool_abu_change,res2$abu_D, paired = T)
anova(lm(res4$accuracy~res4$species+res4$method))
