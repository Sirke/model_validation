visits2 = rep(NA,nr)
for (i in 1:nr){
visits1[i] = sum(sd1$Route==routes[i])
visits2[i] = sum(sd2$Route==routes[i])
}
# COMPUTE MEASURES A AND B
selroutes = routes[which(visits2>=2)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ap2=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (j in 1:ns) {
for (i in 1:nsr){
take = which(sd2$Route == selroutes[i] & y2[,j]>-1)
Ap1[i,j] = mean(pm1p2[take,j])
Ap2[i,j] = mean(pm2p2[take,j])
Ay[i,j] = mean(y2[take,j],na.rm=T)
}}
A = rep(NA,ns)
B = rep(NA,ns)
for (i in 1:ns){
A[i] = cor(Ap2[,i],Ay[,i],use="na.or.complete")   #lisäsin tähän määreen
B[i] = cor(Ap1[,i],Ay[,i],use="na.or.complete")
}
plot(A,B,xlim=c(-1,1), ylim=c(-1,1)) + abline(0,1)+ abline(h=0)+ abline(v=0)
# COMPUTE MEASURES C AND D
selroutes = routes[which(visits1>=2 & visits2>=2)]
nsr = length(selroutes)
Ap1=matrix(NA,nrow = nsr,ncol = ns)
Ap2=matrix(NA,nrow = nsr,ncol = ns)
Ay=matrix(NA,nrow = nsr,ncol = ns)
for (j in 1:ns){
for (i in 1:nsr){
take1 = which(sd1$Route == selroutes[i] & y1[,j]>-1)
take2 = which(sd2$Route == selroutes[i]& y2[,j]>-1)
Ap1[i,j] = mean(pm1p2[take2,j])-mean(pm1p1[take1,j]) #ka laskettava vain vuosilta, jolloin lajia on havaittu
Ap2[i,j] = mean(pm2p2[take2,j])-mean(pm2p1[take1,j]) #riittää, että on edes kerran pystytty laskemaan lajia
Ay[i,j] = mean(y2[take2,j],na.rm=T)- mean(y1[take1,j],na.rm=T) #NA:t eivät saa estää keskiarvon laskemista koko lajille.
}}
C = rep(NA,ns)
D = rep(NA,ns)
for (i in 1:ns){
C[i] = cor(Ap2[,i],Ay[,i],use="na.or.complete")    #lisäsin tähän määreen
D[i] = cor(Ap1[,i],Ay[,i],use="na.or.complete")
}
plot(C,D,xlim=c(-1,1), ylim=c(-1,1)) + abline(0,1)+ abline(h=0)+ abline(v=0)
meres=c(mean(A,na.rm = TRUE),mean(B,na.rm = TRUE),mean(C,na.rm = TRUE),mean(D,na.rm = TRUE))
names(meres)=c("A","B","C","D")
meres
#save as datatable
species=colnames(Y)
abu_results=data.frame(species,A,B,C,D)
setnames(abu_results,c("A","B","C","D"),c("abu_A","abu_B","abu_C","abu_D"))
write.csv(abu_results, "abu_results.csv",row.names = F)
#combine data frames
res=inner_join(pa_results,abu_results,by="species")
#save as csv for further analysis
write.csv(res,"results.csv",row.names = F)
abu_results
pred=Ap1[,21]
obs=Ay[,21]
laji=as.data.frame(cbind(pred,obs))
#tarkistus
cor(pred,obs, use="na.or.complete")
#kuvaaja
ggplot(laji, aes(x=pred,y=obs))+ geom_point()+ xlim(-2,2)+ylim(-2,2)+ geom_abline(intercept = 0, slope =1) + geom_hline(yintercept=0) + geom_vline(xintercept = 0) +ggtitle("Viherpeippo")
#entäpä pohjansirkku?
pred=Ap1[,40]
obs=Ay[,40]
laji=as.data.frame(cbind(pred,obs))
#tarkistus
cor(pred,obs, use="na.or.complete")
#kuvaaja
ggplot(laji, aes(x=pred,y=obs))+ geom_point()+ xlim(-2,2)+ylim(-2,2)+ geom_abline(intercept = 0, slope =1) + geom_hline(yintercept=0) + geom_vline(xintercept = 0) +ggtitle("Pohjansirkku")
#kannanmuutostrendien tarkastelu, lasketaan kaikilta linjoilta ennustetut ja todelliset kannanmuutokset
Ap1<-as.data.frame(Ap1)
Ap2<-as.data.frame(Ap2)
Ay<-as.data.frame(Ay)
#aineisto, jossa kullekin lajille laskettu kaikilta linjoilta ennustettu ja todellinen muutoksen keskiarvo (EI siis korrelaatio
# ennusteiden ja oikeiden muutosten v?lill? kuten aiemmin on laskettu)
kat=colnames(Y)
kat=as.data.frame(kat)
kat$Ap1k=colMeans(Ap1,na.rm = T)
kat$Ap2k<-colMeans(Ap2,na.rm = T)
kat$Ayk<-colMeans(Ay,na.rm = T)
ggplot(kat, aes(x=Ap2k, y=Ayk))+ geom_point()+
geom_hline(yintercept = 0, color = "black")+
geom_vline(xintercept = 0, color = "black")+
xlab("Mean predicted change, C")+
ylab("Mean observed change")+
geom_abline(intercept = 0, slope = 1, color="red",linetype="dashed", size=1.5)+
geom_text(aes(label=kat),hjust=0, vjust=0) +  geom_smooth(method=lm,se=F)
ggplot(kat, aes(x=Ap1k, y=Ayk))+
geom_point()+ geom_hline(yintercept = 0, color = "black")+
geom_vline(xintercept = 0, color = "black")+
xlab("Mean predicted change, D")+
ylab("Mean observed change")+
geom_abline(intercept = 0, slope = 1, color="red",linetype="dashed", size=1.5)+
geom_text(aes(label=kat),hjust=0, vjust=0)+  geom_smooth(method=lm,se=F)
write.csv(kat,"mean_observed_predicted_changes_abu.csv",row.names = F)
ggplot(kat, aes(x=Ap1k, y=Ayk))+
geom_point()+ geom_hline(yintercept = 0, color = "black")+
geom_vline(xintercept = 0, color = "black")+
xlab("Mean predicted change, D")+
ylab("Mean observed change")+
geom_abline(intercept = 0, slope = 1, color="red",linetype="dashed", size=1.5)+
geom_text(aes(label=kat),hjust=0, vjust=0)+  geom_smooth()
write.csv(kat,"mean_observed_predicted_changes_abu.csv",row.names = F)
ggplot(kat, aes(x=Ap1k, y=Ayk))+
geom_point()+ geom_hline(yintercept = 0, color = "black")+
geom_vline(xintercept = 0, color = "black")+
xlab("Mean predicted change, D")+
ylab("Mean observed change")+
geom_abline(intercept = 0, slope = 1, color="red",linetype="dashed", size=1.5)+
geom_text(aes(label=kat),hjust=0, vjust=0)+  geom_smooth(method=lm,se=F)
write.csv(kat,"mean_observed_predicted_changes_abu.csv",row.names = F)
ggplot(kat, aes(x=Ap1k, y=Ayk))+
geom_point()+ geom_hline(yintercept = 0, color = "black")+
geom_vline(xintercept = 0, color = "black")+
xlab("Mean predicted change, D")+
ylab("Mean observed change")+
geom_abline(intercept = 0, slope = 1, color="red",linetype="dashed", size=1.5)+
geom_text(aes(label=kat),hjust=0, vjust=0)+  geom_smooth(method=lm,se=F) +xlim(-0.3,0.3)+ylim(-1,1)
ggplot(kat, aes(x=Ap1k, y=Ayk))+
geom_point()+ geom_hline(yintercept = 0, color = "black")+
geom_vline(xintercept = 0, color = "black")+
xlab("Mean predicted change, D")+
ylab("Mean observed change")+
geom_abline(intercept = 0, slope = 1, color="red",linetype="dashed", size=1.5)+
geom_text(aes(label=kat),hjust=0, vjust=0)+  geom_smooth(method=lm,se=F) +xlim(-1,1)+ylim(-1,1)
ggplot(kat, aes(x=Ap1k, y=Ayk))+
geom_point()+ geom_hline(yintercept = 0, color = "black")+
geom_vline(xintercept = 0, color = "black")+
xlab("Mean predicted change, D")+
ylab("Mean observed change")+
geom_abline(intercept = 0, slope = 1, color="red",linetype="dashed", size=1.5)+
geom_text(aes(label=kat),hjust=0, vjust=0)+  geom_smooth(method=lm,se=F) +xlim(-0.3,0.3)+ylim(-1,1)
write.csv(kat,"mean_observed_predicted_changes_abu.csv",row.names = F)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2")
lapply(packages,library,character.only=T)
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
#pa
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(res_pa$method)
str(res_pa)
summary(res_pa)
#two-way anova
anova(lm(res_pa$accuracy~res_pa$method+res_pa$species))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(res_pa$accuracy, res_pa$method, p.adj="bonferroni")
View(res_pa)
m1=lme(accuracy~method, random=~1|species,data=res_pa)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4")
lapply(packages,library,character.only=T)
m1=lme(accuracy~method, random=~1|species,data=res_pa)
m1=lmer(accuracy~method, random=~1|species,data=res_pa)
m1=lmer(accuracy~method+(1|species),data=res_pa)
summary(m1)
#pa
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(res_pa$method)
str(res_pa)
summary(res_pa)
#sekamalli, joka huomioi lajin random-tekijänä
m1=lmer(accuracy~method+(1|species),data=res_pa)
summary(m1)
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(res_pa$accuracy, res_pa$method, p.adj="bonferroni")
boxplot(res[-1])+abline(0,0)
boxplot(res[-1])+abline(h=0)
boxplot(res[-1])
View(res)
View(res_pa)
revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D"))
levels(res_pa$method)
res_pa$method=revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D"))
res_pa$pa=NA
res_pa$pa=1
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(res_abu$method)
res_abu$method=revalue(res_abu$method,c("abu_A"="A","abu_B"="B","abu_C"="C","abu_D"="D"))
res_abu$pa=0
res2=rbind(res_pa,res_abu)
View(res2)
m1=lmer(accuracy~method*pa+(1|species),data=res_pa)
summary(m1)
m1=lmer(accuracy~method*pa+(1|species),data=res2)
summary(m1)
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
#pa
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(res_pa$method)
str(res_pa)
summary(res_pa)
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
#aineiston muokkaus:
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(res_pa$method)
res_pa$method=revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D"))
res_pa$pa=1
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(res_abu$method)
res_abu$method=revalue(res_abu$method,c("abu_A"="A","abu_B"="B","abu_C"="C","abu_D"="D"))
res_abu$pa=0
res2=rbind(res_pa,res_abu)
p=ggplot(res2,aes(x=method, y=accuracy,group=method)+geom_boxplot()
p
p
p=ggplot(res2,aes(x=method, y=accuracy,group=method)+geom_boxplot()
p
p=ggplot(res2,aes(x=method, y=accuracy,group=method))+geom_boxplot()
p
p=ggplot(res2,aes(x=method, y=accuracy,group=pa))+geom_boxplot()
p
p=ggplot(res2,aes(x=method, y=accuracy))+geom_boxplot()
p
p=ggplot(res2,aes(x=method, y=accuracy))+geom_boxplot()+facet_grid(pa~.)
p
p=ggplot(res2,aes(x=method, y=accuracy))+geom_boxplot()+facet_grid(~.pa)
p
p=ggplot(res2,aes(x=method, y=accuracy))+geom_boxplot()+facet_grid(.~pa)
p
ggplot(res2,aes(x=method, y=accuracy))+geom_boxplot()+facet_grid(.~pa)
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
#aineiston muokkaus:
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(res_pa$method)
res_pa$method=revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D"))
res_pa$pa=pa
#aineiston muokkaus:
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(res_pa$method)
res_pa$method=revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D"))
res_pa$pa="pa"
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(res_abu$method)
res_abu$method=revalue(res_abu$method,c("abu_A"="A","abu_B"="B","abu_C"="C","abu_D"="D"))
res_abu$pa="abu"
res2=rbind(res_pa,res_abu)
ggplot(res2,aes(x=method, y=accuracy))+geom_boxplot()+facet_grid(.~pa)
str(res2)
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(res_abu$method)
res_abu$method=as.factor(revalue(res_abu$method,c("abu_A"="A","abu_B"="B","abu_C"="C","abu_D"="D")))
res_abu$pa="abu"
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D")))
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
#aineiston muokkaus:
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D")))
res_pa$pa="pa"
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(revalue(res_abu$method,c("abu_A"="A","abu_B"="B","abu_C"="C","abu_D"="D")))
res_abu$pa="abu"
res2=rbind(res_pa,res_abu)
str(res2)
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D")))
res_pa$pa=as.factor("pa")
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(revalue(res_abu$method,c("abu_A"="A","abu_B"="B","abu_C"="C","abu_D"="D")))
res_abu$pa=as.factor("abu")
res2=rbind(res_pa,res_abu)
str(res2)
View(res2)
ggplot(res2,aes(x=method, y=accuracy))+geom_boxplot()+facet_grid(.~pa)
m1=lmer(accuracy~method*pa+(1|species),data=res2)
m0=lm(accuracy~method*pa,data=res2)
summary(m0)
dropi1(m0,test="F")
drop1(m0,test="F")
E1=rstandard(m0)
F1=fitted(m0)
E1=rstandard(m0)
F1=fitted(m0)
par(mfrow=c(2,2), mar=c(5,5,2,2))
plot(x=F1,y=E1,xlab="fitted",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~method,xlab="method",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~pa,xlab="pa",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~species,xlab="species",ylab="residuals",data=res2)
abline(h=0,lty=2)
m1=lm(accuracy~method*pa*species,data=res2)
summary(m1)
drop1(m1,test="F")
m1=lm(accuracy~method*species,data=res2)
summary(m1)
drop1(m1,test="F")
E1=rstandard(m1)
F1=fitted(m1)
par(mfrow=c(2,2), mar=c(5,5,2,2))
plot(x=F1,y=E1,xlab="fitted",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~method,xlab="method",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~pa,xlab="pa",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~species,xlab="species",ylab="residuals",data=res2)
abline(h=0,lty=2)
m1=lm(accuracy~method*pa*species,data=res2)
summary(m1)
summary(m1)
drop1(m0,test="F")
m0=lm(accuracy~method*pa,data=res2)
summary(m0)
drop1(m0,test="F")
summary(m0)
m2=lmer(accuracy~method+pa+(1|species),data=res2)
m3=lmer(accuracy~method+(1|species),data=res2)
summary(m2)
AIC(m1,m2,m3)
m1=lmer(accuracy~method*pa+(1|species),data=res2)
m2=lmer(accuracy~method+pa+(1|species),data=res2)
m3=lmer(accuracy~method+(1|species),data=res2)
AIC(m1,m2,m3)
summary(m1)
m1=lme4::lmer(accuracy~method*pa+(1|species),data=res2)
summary(m1)
E1=resid(m1)
F1=fitted(m1)
A1=gls(accuracy~1+method*pa,method="REML",data=res2)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4","nlme")
lapply(packages,library,character.only=T)
A1=gls(accuracy~1+method*pa,method="REML",data=res2)
A3=lme(accuracy~1+method*pa,data=res2,random=~1+method|species,method="REML")
A1=gls(accuracy~1+method*pa,method="REML",data=res2)
A2=lme(accuracy~1+method*pa,data=res2,random=~1|species,method="REML")
A3=lme(accuracy~1+method*pa,data=res2,random=~1+method|species,method="REML")
AIC(A1,A2)
summary(A2)
anova(A1,A2)
summary(A2)
E1=resid(A2, type="normalized")
F1=fitted(A2)
plot(x=F1,y=E1,xlab="fitted",ylab="residuals")
par(mfrow=c(2,2), mar=c(5,5,2,2))
plot(x=F1,y=E1,xlab="fitted",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~method,xlab="method",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~pa,xlab="pa",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~species,xlab="species",ylab="residuals",data=res2)
abline(h=0,lty=2)
anova(A2)
A2full=lme(accuracy~1+method*pa,data=res2,random=~1|species,method="ML")
A1=gls(accuracy~method*pa,method="REML",data=res2)
A2=lme(accuracy~method*pa,data=res2,random=~1|species,method="REML")
AIC(A1,A2)
anova(A1,A2)
summary(A2)
E1=resid(A2, type="normalized")
F1=fitted(A2)
par(mfrow=c(2,2), mar=c(5,5,2,2))
plot(x=F1,y=E1,xlab="fitted",ylab="residuals")
abline(h=0,lty=2)
boxplot(E1~method,xlab="method",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~pa,xlab="pa",ylab="residuals",data=res2)
abline(h=0,lty=2)
boxplot(E1~species,xlab="species",ylab="residuals",data=res2)
abline(h=0,lty=2)
anova(A2full,A2.a)
A2full=lme(accuracy~method*pa,data=res2,random=~1|species,method="ML")
A2.a=lme(accuracy~method+pa,data=res2,random=~1|species,method="ML")
A2.b=lme(accuracy~method,data=res2,random=~1|species,method="ML")
A2.a=lme(accuracy~pa,data=res2,random=~1|species,method="ML")
anova(A2full,A2.a)
A2=lme(accuracy~method*pa,data=res2,random=~1|species,method="REML")
A2full=lme(accuracy~method*pa,data=res2,random=~1|species,method="ML")
A2.a=lme(accuracy~method+pa,data=res2,random=~1|species,method="ML")
A2.b=lme(accuracy~method,data=res2,random=~1|species,method="ML")
A2.a=lme(accuracy~pa,data=res2,random=~1|species,method="ML")
A2full=lme(accuracy~method*pa,data=res2,random=~1|species,method="ML")
A2.a=lme(accuracy~method+pa,data=res2,random=~1|species,method="ML")
A2.b=lme(accuracy~method,data=res2,random=~1|species,method="ML")
A2.c=lme(accuracy~pa,data=res2,random=~1|species,method="ML")
anova(A2full,A2.a)
anova(A2.a,A2.b)
anova(A2.b,A2.c)
AIC(A2full,A2.a,A2.b,A2.c)
summary(A2)
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)
Line=cbind(Line,Line2)
Line=cbind(Line,Line3)
Line=as.data.frame(Line)
#pdf("Fig1.pdf")
#jpeg("Fig1abcdef.jpeg")
#png("Fig1abcdef.png")
#määrittää 3x3 matriisin johon kuvat piirretään
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))
# a)
plot(pa_B~pa_A,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"a) Distribution",cex=0.8)
# b)
plot(abu_B~abu_A,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"b) Abundance",cex=0.8)
# c)
plot(pa_D~pa_C,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)
# d)
plot(abu_D~abu_C,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)
#dev.off()
