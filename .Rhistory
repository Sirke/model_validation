#pa
rres_pa=rres[,1:5]
#omitting rows with NA's
rres_pa=na.omit(rres_pa)
rres_pa=gather(rres_pa,"method","accuracy",2:5)
rres_pa$method=as.factor(rres_pa$method)
summary(rres_pa)
#two-way anova
anova(lm(rres_pa$accuracy~rres_pa$method+rres_pa$selroutes))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(rres_pa$accuracy, rres_pa$method, p.adj="bonferroni")
#abu
rres_abu=rres[,c(1,6:9)]
#omitting rows with NA's
rres_abu=na.omit(rres_abu)
rres_abu=gather(rres_abu,"method","accuracy",2:5)
rres_abu$method=as.factor(rres_abu$method)
summary(rres_abu)
#two-way anova
anova(lm(rres_abu$accuracy~rres_abu$method+rres_abu$selroutes))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(rres_abu$accuracy, rres_abu$method, p.adj="bonferroni")
#A pa ja abu välillä
t.test(rres$pa_corA,rres$abu_corA, paired=TRUE)
#B pa ja abu välillä
t.test(rres$pa_corB,rres$abu_corB, paired=TRUE)
#change pa ja abu välillä
t.test(rres$pa_corC,rres$abu_corC, paired=TRUE)
#change pa ja abu välillä
t.test(rres$pa_corD,rres$abu_corD, paired=TRUE)
# Piirretään kuvaaja, Fig1
#määritetään kuvalle raamit ja nimi
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)
Line=cbind(Line,Line2)
Line=cbind(Line,Line3)
Line=as.data.frame(Line)
#pdf("Fig1.pdf")
#jpeg("Fig1abcdef.jpeg")
#png("Fig1abcdef.png")
#määrittää 3x3 matriisin johon kuvat piirretään
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))
# a)
plot(pa_corB~pa_corA,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"a) Distribution",cex=0.8)
# b)
plot(abu_corB~abu_corA,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"b) Abundance",cex=0.8)
# c)
plot(pa_corD~pa_corC,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)
# d)
plot(abu_corD~abu_corC,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)
#dev.off()
ggplot(rres, aes(pa_corD)) +
geom_histogram()
ggplot(rres, aes(x=y, y=pa_corA))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corB))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corC))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corD))+ geom_point()+ geom_smooth()
ggplot(rres,aes(x=x,y=y))+geom_point()
rresNA=na.omit(rres)
M1=lm(pa_corD~y,data = rresNA)
summary(M1)
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
plot(M1,add.smooth = F,which = 1)
E<-resid(M1)
hist(E, xlab = "residuals",main = "")
plot(rresNA$pa_corD,E,xlab = "accuracy(D)",ylab="residuals")
par(op)
ggplot(rres, aes(abu_corD)) +
geom_histogram()
ggplot(rres, aes(x=y, y=abu_corA))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corB))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corC))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corD))+ geom_point()+geom_smooth()
M1=lm(abu_corD~y,data = rresNA)
summary(M1)
ggplot(rres, aes(x=y, y=pa_corC))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corD))+ geom_point()+ geom_smooth()
ggplot(rres,aes(x=x,y=y))+geom_point()
ggplot(rres, aes(x=y, y=abu_corA))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corB))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corC))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corD))+ geom_point()+geom_smooth()
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
#pa
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(res_pa$method)
summary(res_pa)
#two-way anova
anova(lm(res_pa$accuracy~res_pa$method+res_pa$species))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(res_pa$accuracy, res_pa$method, p.adj="bonferroni")
#abu
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(res_abu$method)
summary(res_abu)
#two-way anova
anova(lm(res_abu$accuracy~res_abu$method+res_abu$species))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(res_abu$accuracy, res_abu$method, p.adj="bonferroni")
#A pa ja abu välillä
t.test(res$pa_A,res$abu_A, paired=TRUE)
#B pa ja abu välillä
t.test(res$pa_B,res$abu_B, paired=TRUE)
#change pa ja abu välillä
t.test(res$pa_C,res$abu_C, paired=TRUE)
#change pa ja abu välillä
t.test(res$pa_D,res$abu_D, paired=TRUE)
# Piirretään kuvaaja, Fig1
#määritetään kuvalle raamit ja nimi
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)
Line=cbind(Line,Line2)
Line=cbind(Line,Line3)
Line=as.data.frame(Line)
#pdf("Fig1.pdf")
#jpeg("Fig1abcdef.jpeg")
#png("Fig1abcdef.png")
#määrittää 3x3 matriisin johon kuvat piirretään
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))
# a)
plot(pa_B~pa_A,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"a) Distribution",cex=0.8)
# b)
plot(abu_B~abu_A,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"b) Abundance",cex=0.8)
# c)
plot(pa_D~pa_C,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)
# d)
plot(abu_D~abu_C,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)
#dev.off()
#data in
rres=read.csv("route_results.csv")
#Compute means and standard errors
rres %>% dplyr::select(2:9)%>%colMeans(,na.rm=T)
rres %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(rres[-c(1,10:11)])
#pa
rres_pa=rres[,1:5]
#omitting rows with NA's
rres_pa=na.omit(rres_pa)
rres_pa=gather(rres_pa,"method","accuracy",2:5)
rres_pa$method=as.factor(rres_pa$method)
summary(rres_pa)
#two-way anova
anova(lm(rres_pa$accuracy~rres_pa$method+rres_pa$selroutes))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(rres_pa$accuracy, rres_pa$method, p.adj="bonferroni")
#abu
rres_abu=rres[,c(1,6:9)]
#omitting rows with NA's
rres_abu=na.omit(rres_abu)
rres_abu=gather(rres_abu,"method","accuracy",2:5)
rres_abu$method=as.factor(rres_abu$method)
summary(rres_abu)
#two-way anova
anova(lm(rres_abu$accuracy~rres_abu$method+rres_abu$selroutes))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(rres_abu$accuracy, rres_abu$method, p.adj="bonferroni")
#A pa ja abu välillä
t.test(rres$pa_corA,rres$abu_corA, paired=TRUE)
#B pa ja abu välillä
t.test(rres$pa_corB,rres$abu_corB, paired=TRUE)
#change pa ja abu välillä
t.test(rres$pa_corC,rres$abu_corC, paired=TRUE)
#change pa ja abu välillä
t.test(rres$pa_corD,rres$abu_corD, paired=TRUE)
# Piirretään kuvaaja, Fig1
#määritetään kuvalle raamit ja nimi
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)
Line=cbind(Line,Line2)
Line=cbind(Line,Line3)
Line=as.data.frame(Line)
#pdf("Fig1.pdf")
#jpeg("Fig1abcdef.jpeg")
#png("Fig1abcdef.png")
#määrittää 3x3 matriisin johon kuvat piirretään
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))
# a)
plot(pa_corB~pa_corA,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"a) Distribution",cex=0.8)
# b)
plot(abu_corB~abu_corA,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"b) Abundance",cex=0.8)
# c)
plot(pa_corD~pa_corC,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)
# d)
plot(abu_corD~abu_corC,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)
#dev.off()
#ennustustarkkuuksien jakauma
ggplot(rres, aes(pa_corD)) + geom_histogram()
#kuvaajia, plotataan linjakohtaiset ennustustarkkuudet latitudea vasten
ggplot(rres, aes(x=y, y=pa_corA))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corB))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corC))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corD))+ geom_point()+ geom_smooth()
#Kaikki mukaan valikoituneet reitit kartalla
ggplot(rres,aes(x=x,y=y))+geom_point()
#na.omit
rresNA=na.omit(rres)
#testataan selittääkö latitude (y) ennustustarkkuutta (corD)
M1=lm(pa_corD~y,data = rresNA)
summary(M1)
#mallin validointi
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
plot(M1,add.smooth = F,which = 1)
E<-resid(M1)
hist(E, xlab = "residuals",main = "")
plot(rresNA$pa_corD,E,xlab = "accuracy(D)",ylab="residuals")
par(op)
#ennustustarkkuuksien jakautuminen
ggplot(rres, aes(abu_corD)) + geom_histogram()
#kuvaajia, plotataan linjakohtaiset ennustustarkkuudet latitudea vasten
ggplot(rres, aes(x=y, y=abu_corA))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corB))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corC))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corD))+ geom_point()+geom_smooth()
#testataan selittääkö latitude (y) ennustustarkkuutta (corD)
M1=lm(abu_corD~y,data = rresNA)
summary(M1)
#mallin validointi
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
plot(M1,add.smooth = F,which = 1)
E<-resid(M1)
hist(E, xlab = "residuals",main = "")
plot(rres$abu_corD,E,xlab = "accuracy(D)",ylab="residuals")
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","dplyr","plyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
#Compute means and standard errors
res %>% dplyr::select(2:9)%>%colMeans()
res %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(res[-1])
#pa
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(res_pa$method)
summary(res_pa)
#two-way anova
anova(lm(res_pa$accuracy~res_pa$method+res_pa$species))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(res_pa$accuracy, res_pa$method, p.adj="bonferroni")
#abu
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(res_abu$method)
summary(res_abu)
#two-way anova
anova(lm(res_abu$accuracy~res_abu$method+res_abu$species))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(res_abu$accuracy, res_abu$method, p.adj="bonferroni")
#A pa ja abu välillä
t.test(res$pa_A,res$abu_A, paired=TRUE)
#B pa ja abu välillä
t.test(res$pa_B,res$abu_B, paired=TRUE)
#change pa ja abu välillä
t.test(res$pa_C,res$abu_C, paired=TRUE)
#change pa ja abu välillä
t.test(res$pa_D,res$abu_D, paired=TRUE)
# Piirretään kuvaaja, Fig1
#määritetään kuvalle raamit ja nimi
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)
Line=cbind(Line,Line2)
Line=cbind(Line,Line3)
Line=as.data.frame(Line)
#pdf("Fig1.pdf")
#jpeg("Fig1abcdef.jpeg")
#png("Fig1abcdef.png")
#määrittää 3x3 matriisin johon kuvat piirretään
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))
# a)
plot(pa_B~pa_A,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"a) Distribution",cex=0.8)
# b)
plot(abu_B~abu_A,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"b) Abundance",cex=0.8)
# c)
plot(pa_D~pa_C,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)
# d)
plot(abu_D~abu_C,data=res,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)
#dev.off()
#data in
rres=read.csv("route_results.csv")
#Compute means and standard errors
rres %>% dplyr::select(2:9)%>%colMeans(,na.rm=T)
rres %>% dplyr::select(2:9)%>%std.error()
#kuvaaja
boxplot(rres[-c(1,10:11)])
#pa
rres_pa=rres[,1:5]
#omitting rows with NA's
rres_pa=na.omit(rres_pa)
rres_pa=gather(rres_pa,"method","accuracy",2:5)
rres_pa$method=as.factor(rres_pa$method)
summary(rres_pa)
#two-way anova
anova(lm(rres_pa$accuracy~rres_pa$method+rres_pa$selroutes))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(rres_pa$accuracy, rres_pa$method, p.adj="bonferroni")
#abu
rres_abu=rres[,c(1,6:9)]
#omitting rows with NA's
rres_abu=na.omit(rres_abu)
rres_abu=gather(rres_abu,"method","accuracy",2:5)
rres_abu$method=as.factor(rres_abu$method)
summary(rres_abu)
#two-way anova
anova(lm(rres_abu$accuracy~rres_abu$method+rres_abu$selroutes))
#pairwise comparisons, bonferroni correction for multiple testing
pairwise.t.test(rres_abu$accuracy, rres_abu$method, p.adj="bonferroni")
#A pa ja abu välillä
t.test(rres$pa_corA,rres$abu_corA, paired=TRUE)
#B pa ja abu välillä
t.test(rres$pa_corB,rres$abu_corB, paired=TRUE)
#change pa ja abu välillä
t.test(rres$pa_corC,rres$abu_corC, paired=TRUE)
#change pa ja abu välillä
t.test(rres$pa_corD,rres$abu_corD, paired=TRUE)
# Piirretään kuvaaja, Fig1
#määritetään kuvalle raamit ja nimi
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)
Line=cbind(Line,Line2)
Line=cbind(Line,Line3)
Line=as.data.frame(Line)
#pdf("Fig1.pdf")
#jpeg("Fig1abcdef.jpeg")
#png("Fig1abcdef.png")
#määrittää 3x3 matriisin johon kuvat piirretään
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))
# a)
plot(pa_corB~pa_corA,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"a) Distribution",cex=0.8)
# b)
plot(abu_corB~abu_corA,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"b) Abundance",cex=0.8)
# c)
plot(pa_corD~pa_corC,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)
# d)
plot(abu_corD~abu_corC,data=rres,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)
#dev.off()
#ennustustarkkuuksien jakauma
ggplot(rres, aes(pa_corD)) + geom_histogram()
#kuvaajia, plotataan linjakohtaiset ennustustarkkuudet latitudea vasten
ggplot(rres, aes(x=y, y=pa_corA))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corB))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corC))+ geom_point()+ geom_smooth()
ggplot(rres, aes(x=y, y=pa_corD))+ geom_point()+ geom_smooth()
#Kaikki mukaan valikoituneet reitit kartalla
ggplot(rres,aes(x=x,y=y))+geom_point()
#na.omit
rresNA=na.omit(rres)
#testataan selittääkö latitude (y) ennustustarkkuutta (corD)
M1=lm(pa_corD~y,data = rresNA)
summary(M1)
#mallin validointi
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
plot(M1,add.smooth = F,which = 1)
E<-resid(M1)
hist(E, xlab = "residuals",main = "")
plot(rresNA$pa_corD,E,xlab = "accuracy(D)",ylab="residuals")
par(op)
#ennustustarkkuuksien jakautuminen
ggplot(rres, aes(abu_corD)) + geom_histogram()
#kuvaajia, plotataan linjakohtaiset ennustustarkkuudet latitudea vasten
ggplot(rres, aes(x=y, y=abu_corA))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corB))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corC))+ geom_point()+geom_smooth()
ggplot(rres, aes(x=y, y=abu_corD))+ geom_point()+geom_smooth()
#testataan selittääkö latitude (y) ennustustarkkuutta (corD)
M1=lm(abu_corD~y,data = rresNA)
summary(M1)
#mallin validointi
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
plot(M1,add.smooth = F,which = 1)
E<-resid(M1)
hist(E, xlab = "residuals",main = "")
plot(rres$abu_corD,E,xlab = "accuracy(D)",ylab="residuals")
plot(rresNA$abu_corD,E,xlab = "accuracy(D)",ylab="residuals")
