theme_bw() +
geom_boxplot()+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_factors.pdf",device="pdf",width=25,height=12,units="cm")
resPA %>%
mutate(migration = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(logmass, accuracy,color=migration)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("log(Mass)")+
ylab("Prediction accuracy")+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_mass_by_migration.pdf",device="pdf",width=25,height=12,units="cm")
resPA %>%
mutate(migration = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(PrevS, accuracy,color=migration)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
#geom_point(position=pd) +
facet_grid(pool ~ method)+
xlab("log(Prevalence)")+
ylab("Prediction accuracy")+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_prev_by_migration.pdf",device="pdf",width=25,height=12,units="cm")
#tai jokainen trait erikseen:
resPA %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)))+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_habitat.pdf",device="pdf",width=25,height=12,units="cm")
resPA %>%
mutate(Mig = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(Mig, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Mig)))+
facet_grid(pool ~ method)+
xlab("Migration behavior")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_migration.pdf",device="pdf",width=25,height=12,units="cm")
resPA %>%
ggplot(aes(exp(logmass), accuracy)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("Mass (kg)")+
ylab("Prediction accuracy")+
scale_x_continuous(breaks=c(0,5000, 10000),labels=c("0","5","10"))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_mass.pdf",device="pdf",width=25,height=12,units="cm")
resPA %>%
ggplot(aes(exp(PrevS), accuracy)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("Prevalence")+
ylab("Prediction accuracy")+
scale_x_continuous(breaks=c(0.3,0.6, 0.9),labels=c("0.3","0.6","0.9"))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_mass.pdf",device="pdf",width=25,height=12,units="cm")
#tai jokainen trait erikseen:
resPA %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)))+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_habitat.png",device="png",width=25,height=12,units="cm")
resPA %>%
mutate(Mig = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(Mig, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Mig)))+
facet_grid(pool ~ method)+
xlab("Migration behavior")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_migration.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("pa_raw_data_plot_migration.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("pa_raw_data_plot_migration.png",device="png",width=25,height=12,units="cm")
#tai jokainen trait erikseen:
resABU %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)))+
#geom_point(position=pd) +
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("abu_raw_data_plot_habitat.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("abu_raw_data_plot_habitat.png",device="png",width=25,height=12,units="cm")
ggsave("abu_raw_data_plot_migration.png",device="png",width=25,height=12,units="cm")
resABU %>%
mutate(Mig = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(Mig, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Mig)))+
facet_grid(pool ~ method)+
xlab("Migration behavior")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position='none')
knitr::opts_chunk$set(echo = TRUE)
getwd()
paketit<-c("lme4","nlme","readr","tidyr","plyr","dplyr","magrittr","purrr","ggplot2","ape","MuMIn","Hmisc","MCMCglmm","bayesplot","rstanarm","ggeffects","viridis")
lapply(paketit,library,character.only=T)
#aineiston valinta, leväyttäminen ja uudelleen nimeäminen
poolres<-read.csv("poolres.csv")
#lisätään lajiominaisuudet taulukkoon
traits<-read.csv("traits_table.csv",sep = ";")
results<-inner_join(poolres,traits,by="species")
str(results)
results$species=as.factor(results$species)
#uusi muuttuja, massan logaritmi
results$logmass<-log(results$Mass)
#uusi muuttuja, log-muunnettu prevalenssi
results$PrevS=log(results$Prev)
#arcsin-muunnos (kokeiltu)
#asinTransform <- function(p) { asin(sqrt(p)) }
#results$PrevS=asinTransform(results$Prev)
#logit-muunnos (kokeilin, antaa ihan samanlaiset residuaalit)
#logitTransform <- function(p) { log(p/(1-p)) }
#results$PrevS=logitTransform(results$Prev)
#tallenna tarvittaessa omaksi taulukokseen
#write.csv(results,"accuracies_traits.csv",row.names = F)
#jaetaan aineisto pa ja abu aineistoihin
resPA=subset(results,pa=="pa")
resABU=subset(results,pa=="abu")
ggplot(resPA, aes(x=Hab, y=accuracy)) +
geom_boxplot(aes(fill=method)) + facet_grid(. ~pool ) +
ggtitle("occurrence data")
ggplot(resABU, aes(x=Hab, y=accuracy)) +
geom_boxplot(aes(fill=method)) + facet_grid(. ~pool ) +
ggtitle("abundance data")
#pa aineisto
ggplot(resPA, aes(x=Mig, y=accuracy)) +
geom_boxplot(aes(fill=method))+ facet_grid(. ~pool ) +
ggtitle("occurrence data")
ggplot(resABU, aes(x=Mig, y=accuracy)) +
geom_boxplot(aes(fill=method))+ facet_grid(. ~pool ) +
ggtitle("abundance data")
#pa aineisto
ggplot(resPA, aes(x=PrevS, y=accuracy,color=method)) +
geom_point () +
geom_smooth(method=lm) +
ggtitle("occurrence data") +
facet_grid(. ~pool)
#abu
ggplot(resABU, aes(x=PrevS, y=accuracy,color=method)) +
geom_point()+
geom_smooth(method=lm) +
facet_grid(. ~pool ) +
ggtitle("abundance data")
#pa aineisto
ggplot(resPA, aes(x=logmass, y=accuracy,color=method)) +
geom_point () +
geom_smooth(method=lm) +
ggtitle("occurrence data") +
facet_grid(. ~pool)
#abu
ggplot(resABU, aes(x=logmass, y=accuracy,color=method)) +
geom_point()+
geom_smooth(method=lm) +
facet_grid(. ~pool ) +
ggtitle("abundance data")
#muokataan muuttujia hieman
resPA$Mig <- factor(resPA$Mig, levels=c("L", "R", "S"), labels=c("long-distance", "resident","short-distance"))
resPA$pool <- factor(resPA$pool, levels=c("NPo", "Po"), labels=c("local", "regional"))
resPA$Hab <- factor(resPA$Hab, levels=c("CU", "FO","MM","WE"), labels=c("cultural", "forests","mountain/mire", "wetland"))
resPA %>%
mutate(migration = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(Hab, accuracy,fill=migration)) +
theme_bw() +
geom_boxplot()+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_factors.pdf",device="pdf",width=25,height=12,units="cm")
resPA %>%
mutate(migration = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(logmass, accuracy,color=migration)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("log(Mass)")+
ylab("Prediction accuracy")+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_mass_by_migration.pdf",device="pdf",width=25,height=12,units="cm")
resPA %>%
mutate(migration = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(PrevS, accuracy,color=migration)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
#geom_point(position=pd) +
facet_grid(pool ~ method)+
xlab("log(Prevalence)")+
ylab("Prediction accuracy")+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_prev_by_migration.pdf",device="pdf",width=25,height=12,units="cm")
#tai jokainen trait erikseen:
resPA %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)))+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_habitat.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("pa_raw_data_plot_habitat.png",device="png",width=25,height=12,units="cm")
resPA %>%
mutate(Mig = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(Mig, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Mig)))+
facet_grid(pool ~ method)+
xlab("Migration behavior")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_migration.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("pa_raw_data_plot_migration.png",device="png",width=25,height=12,units="cm")
resPA %>%
ggplot(aes(exp(logmass), accuracy)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("Mass (kg)")+
ylab("Prediction accuracy")+
scale_x_continuous(breaks=c(0,5000, 10000),labels=c("0","5","10"))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_mass.pdf",device="pdf",width=25,height=12,units="cm")
resPA %>%
ggplot(aes(exp(PrevS), accuracy)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("Prevalence")+
ylab("Prediction accuracy")+
scale_x_continuous(breaks=c(0.3,0.6, 0.9),labels=c("0.3","0.6","0.9"))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("pa_raw_data_plot_mass.pdf",device="pdf",width=25,height=12,units="cm")
#muokataan muuttujia hieman
resABU$Mig <- factor(resABU$Mig, levels=c("L", "R", "S"), labels=c("long-distance", "resident","short-distance"))
resABU$pool <- factor(resABU$pool, levels=c("NPo", "Po"), labels=c("local", "regional"))
resABU$Hab <- factor(resABU$Hab, levels=c("CU", "FO","MM","WE"), labels=c("cultural", "forests","mountain/mire", "wetland"))
resABU %>%
mutate(migration = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
#ggplot(aes(Hab, accuracy, color = migration, group=migration)) +
ggplot(aes(Hab, accuracy,fill=migration)) +
theme_bw() +
geom_boxplot()+
#geom_point(position=pd) +
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("abu_raw_data_plot_factors.pdf",device="pdf",width=25,height=12,units="cm")
resABU %>%
mutate(migration = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(logmass, accuracy,color=migration)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("log(Mass)")+
ylab("Prediction accuracy")+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("abu_raw_data_plot_mass_by_migration.pdf",device="pdf",width=25,height=12,units="cm")
resABU %>%
mutate(migration = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(PrevS, accuracy,color=migration)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
#geom_point(position=pd) +
facet_grid(pool ~ method)+
xlab("log(Prevalence)")+
ylab("Prediction accuracy")+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("abu_raw_data_plot_prev_by_migration.pdf",device="pdf",width=25,height=12,units="cm")
#tai jokainen trait erikseen:
resABU %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)))+
#geom_point(position=pd) +
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("abu_raw_data_plot_habitat.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("abu_raw_data_plot_habitat.png",device="png",width=25,height=12,units="cm")
resABU %>%
mutate(Mig = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(Mig, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Mig)))+
facet_grid(pool ~ method)+
xlab("Migration behavior")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position='none')
ggsave("abu_raw_data_plot_migration.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("abu_raw_data_plot_migration.png",device="png",width=25,height=12,units="cm")
resABU %>%
ggplot(aes(exp(logmass), accuracy)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("Mass (kg)")+
ylab("Prediction accuracy")+
scale_x_continuous(breaks=c(0,5000, 10000),labels=c("0","5","10"))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("abu_raw_data_plot_mass.pdf",device="pdf",width=25,height=12,units="cm")
resABU %>%
ggplot(aes(exp(PrevS), accuracy)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("Prevalence")+
ylab("Prediction accuracy")+
scale_x_continuous(breaks=c(0.3,0.6, 0.9),labels=c("0.3","0.6","0.9"))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("abu_raw_data_plot_prev.pdf",device="pdf",width=25,height=12,units="cm")
#log-skaalalla samat:
resABU %>%
ggplot(aes(logmass, accuracy)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("log(Mass)")+
ylab("Prediction accuracy")+
#scale_x_continuous(breaks=c(0,5000, 10000),labels=c("0","5","10"))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("abu_raw_data_plot_mass_logscale.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("abu_raw_data_plot_mass_logscale.png",device="png",width=25,height=12,units="cm")
resABU %>%
ggplot(aes(PrevS, accuracy)) +
theme_bw() +
geom_point () +
geom_smooth(method=lm) +
facet_grid(pool ~ method)+
xlab("log(Prevalence)")+
ylab("Prediction accuracy")+
#scale_x_continuous(breaks=c(0.3,0.6, 0.9),labels=c("0.3","0.6","0.9"))+
scale_color_viridis(discrete = TRUE, option = "D")+
scale_fill_viridis(discrete = TRUE)
ggsave("abu_raw_data_plot_prevalence_logscale.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("abu_raw_data_plot_prevalence_logscale.png",device="png",width=25,height=12,units="cm")
geom_boxplot(aes(colour=factor(Hab)),notch=T+
#tai jokainen trait erikseen:
resPA %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)),notch=T)+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
#tai jokainen trait erikseen:
resPA %>%
#tai jokainen trait erikseen
resPA %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)),notch=T)+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_habitat.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("pa_raw_data_plot_habitat.png",device="png",width=25,height=12,units="cm")
#tai jokainen trait erikseen
resPA %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)))+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_habitat.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("pa_raw_data_plot_habitat.png",device="png",width=25,height=12,units="cm")
#tai jokainen trait erikseen
resPA %>%
ggplot(aes(Hab, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Hab)))+
facet_grid(pool ~ method)+
xlab("Habitat preference")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
resABU %>%
mutate(Mig = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(Mig, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Mig)))+
facet_grid(pool ~ method)+
xlab("Migration behaviour")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position='none')
ggsave("abu_raw_data_plot_migration.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("abu_raw_data_plot_migration.png",device="png",width=25,height=12,units="cm")
resPA %>%
mutate(Mig = factor(Mig, levels=c("long-distance", "short-distance", "resident"))) %>%
ggplot(aes(Mig, accuracy)) +
theme_bw() +
geom_boxplot(aes(colour=factor(Mig)))+
facet_grid(pool ~ method)+
xlab("Migration behaviour")+
ylab("Prediction accuracy")+
theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=0.9))+
scale_color_viridis(discrete = TRUE, option = "D")+
theme(legend.position="top")+
labs(color = "Habitat preference")+
theme(legend.position='none')
ggsave("pa_raw_data_plot_migration.pdf",device="pdf",width=25,height=12,units="cm")
ggsave("pa_raw_data_plot_migration.png",device="png",width=25,height=12,units="cm")
