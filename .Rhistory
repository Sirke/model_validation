malli15 <- gls(pool_pa_change ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#tehdään model averaging
output2<-model.sel(malli0,malli3,malli8,malli4)
summary(model.avg(output2, revised.var = TRUE))
# sovitetaan malli uudestaan REML asetuksilla
malli0 <- gls(pool_pa_change ~ 1, data = results,correlation=bm.birds,method="REML")
summary(malli0)
op<-par(mfrow=c(2,3),mar=c(5,4,1,2))
plot(malli0,add.smooth = F,which =1)
E<-resid(malli0)
hist(E, xlab = "residuals",main = "")
plot(results$Prev,E,xlab = "prevalence",ylab="residuals")
plot(results$Hab,E,xlab = "habitat",ylab="residuals")
plot(results$Mig,E,xlab = "migration",ylab="residuals")
plot(results$logmass,E,xlab = "logMass",ylab="residuals")
par(op)
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pool_abu_change ~ 1, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli1 <- gls(pool_abu_change ~ Mig, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli2 <- gls(pool_abu_change ~ Hab, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli3 <- gls(pool_abu_change ~ logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli4 <- gls(pool_abu_change ~ PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli5 <- gls(pool_abu_change ~ Mig + Hab, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli6 <- gls(pool_abu_change ~ Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli7 <- gls(pool_abu_change ~ Mig + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli8 <- gls(pool_abu_change ~ logmass+PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli9 <- gls(pool_abu_change ~ Mig +PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli10 <- gls(pool_abu_change ~ Hab+PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli11 <- gls(pool_abu_change ~ Mig + Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli12 <- gls(pool_abu_change ~ Mig + Hab + PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli13 <- gls(pool_abu_change ~ Mig + PrevS + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli14 <- gls(pool_abu_change ~ PrevS + Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli15 <- gls(pool_abu_change ~ Mig + Hab + logmass+PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pool_abu_change ~ 1, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli1 <- gls(pool_abu_change ~ Mig, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli2 <- gls(pool_abu_change ~ Hab, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli3 <- gls(pool_abu_change ~ logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli4 <- gls(pool_abu_change ~ Prev, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli5 <- gls(pool_abu_change ~ Mig + Hab, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli6 <- gls(pool_abu_change ~ Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli7 <- gls(pool_abu_change ~ Mig + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli8 <- gls(pool_abu_change ~ logmass + Prev, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli9 <- gls(pool_abu_change ~ Mig + Prev, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli10 <- gls(pool_abu_change ~ Hab + Prev, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli11 <- gls(pool_abu_change ~ Mig + Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli12 <- gls(pool_abu_change ~ Mig + Hab + Prev, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli13 <- gls(pool_abu_change ~ Mig + Prev + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli14 <- gls(pool_abu_change ~ Prev + Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli15 <- gls(pool_abu_change ~ Mig + Hab + logmass+Prev, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#tehdään model averaging
output2<-model.sel(malli8,malli13,malli14)
summary(model.avg(output2, revised.var = TRUE))
#sovitetaan malli uudestaan REML asetuksilla
malli8 <- gls(pool_abu_change ~ logmass+Prev, data = results,correlation=bm.birds2,method="REML",na.action="na.omit")
summary(malli8)
#plottaus ei toimi jos aineistoissa on eri määrä havaintoja
results2=subset(results,species!="Emberiza_rustica" & species!="Bonasa_bonasia")
#seuraavaksi mallin validointia kuvaajista
op<-par(mfrow=c(2,3),mar=c(5,4,1,2))
plot(malli8)
E<-resid(malli8)
hist(E, xlab = "residuals",main = "")
plot(results2$Prev,E,xlab = "prevalence",ylab="residuals")
plot(results2$Hab,E,xlab = "habitat",ylab="residuals")
plot(results2$Mig,E,xlab = "migration",ylab="residuals")
plot(results2$logmass,E,xlab = "logMass",ylab="residuals")
par(op)
qqnorm(E)
qqline(E)
#pa-aineisto
malli0 <- gls(pool_pa_change ~ 1, data = results,correlation=bm.birds,method="ML")
malli1 <- gls(pool_pa_change ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(pool_pa_change ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(pool_pa_change ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(pool_pa_change ~ PrevS, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(pool_pa_change ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(pool_pa_change ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(pool_pa_change ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(pool_pa_change ~ log(Mass)+PrevS, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(pool_pa_change ~ Mig +PrevS, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(pool_pa_change ~ Hab+PrevS, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(pool_pa_change ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(pool_pa_change ~ Mig + Hab + PrevS, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(pool_pa_change ~ Mig + PrevS + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(pool_pa_change ~ PrevS + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(pool_pa_change ~ Mig + Hab + log(Mass)+PrevS, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#tehdään model averaging
output2<-model.sel(malli0,malli3,malli8,malli4)
summary(model.avg(output2, revised.var = TRUE))
# sovitetaan malli uudestaan REML asetuksilla
malli0 <- gls(pool_pa_change ~ 1, data = results,correlation=bm.birds,method="REML")
summary(malli0)
op<-par(mfrow=c(2,3),mar=c(5,4,1,2))
plot(malli0,add.smooth = F,which =1)
E<-resid(malli0)
hist(E, xlab = "residuals",main = "")
plot(results$PrevS,E,xlab = "prevalence",ylab="residuals")
plot(results$Hab,E,xlab = "habitat",ylab="residuals")
plot(results$Mig,E,xlab = "migration",ylab="residuals")
plot(results$logmass,E,xlab = "logMass",ylab="residuals")
par(op)
#abu-aineisto
#luodaan eri mallivaihtoehtoja
malli0 <- gls(pool_abu_change ~ 1, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli1 <- gls(pool_abu_change ~ Mig, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli2 <- gls(pool_abu_change ~ Hab, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli3 <- gls(pool_abu_change ~ logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli4 <- gls(pool_abu_change ~ PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli5 <- gls(pool_abu_change ~ Mig + Hab, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli6 <- gls(pool_abu_change ~ Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli7 <- gls(pool_abu_change ~ Mig + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli8 <- gls(pool_abu_change ~ logmass+PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli9 <- gls(pool_abu_change ~ Mig +PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli10 <- gls(pool_abu_change ~ Hab+PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli11 <- gls(pool_abu_change ~ Mig + Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli12 <- gls(pool_abu_change ~ Mig + Hab + PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli13 <- gls(pool_abu_change ~ Mig + PrevS + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli14 <- gls(pool_abu_change ~ PrevS + Hab + logmass, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
malli15 <- gls(pool_abu_change ~ Mig + Hab + logmass+PrevS, data = results,correlation=bm.birds2,method="ML",na.action="na.omit")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
#tehdään model averaging
output2<-model.sel(malli8,malli13,malli14)
summary(model.avg(output2, revised.var = TRUE))
#plottaus ei toimi jos aineistoissa on eri määrä havaintoja
results2=subset(results,species!="Emberiza_rustica" & species!="Bonasa_bonasia")
#seuraavaksi mallin validointia kuvaajista
op<-par(mfrow=c(2,3),mar=c(5,4,1,2))
plot(malli8)
E<-resid(malli8)
hist(E, xlab = "residuals",main = "")
plot(results2$PrevS,E,xlab = "prevalence",ylab="residuals")
plot(results2$Hab,E,xlab = "habitat",ylab="residuals")
plot(results2$Mig,E,xlab = "migration",ylab="residuals")
plot(results2$logmass,E,xlab = "logMass",ylab="residuals")
par(op)
qqnorm(E)
qqline(E)
knitr::opts_chunk$set(echo = TRUE)
packages<-c("readr","tidyr","plyr","dplyr","magrittr","purrr","data.table","plotrix","jtools","ggplot2","lme4","nlme")
lapply(packages,library,character.only=T)
getwd()
res<-read.csv("results.csv",header=T,sep=",")
str(res)
res$abu_D[res$P_D<10]=NA
res$abu_C[res$P_D<10]=NA
install.packages(gplots)
install.packages("gplots")
library(gplots)
#aineiston muokkaus:
res_pa=res[,1:5]
res_pa=gather(res_pa,"method","accuracy",2:5)
res_pa$method=as.factor(revalue(res_pa$method,c("pa_A"="A","pa_B"="B","pa_C"="C","pa_D"="D")))
res_pa$pa=as.factor("pa")
res_abu=res[,c(1,6:9)]
res_abu=gather(res_abu,"method","accuracy",2:5)
res_abu$method=as.factor(revalue(res_abu$method,c("abu_A"="A","abu_B"="B","abu_C"="C","abu_D"="D")))
res_abu$pa=as.factor("abu")
res2=rbind(res_pa,res_abu)
str(res2)
summary(res2)
#tallennetaan taulukko, muista, että mukana NA:ta!!
write.csv(res2,"results_with_NA.csv",row.names = F)
plotmeans(res$accuracy~res$pa_B)
plotmeans(res$accuracy~res$pa_B,data=res2, frame=FALSE)
plotmeans(res2$accuracy~res2$pa_B,data=res2, frame=FALSE)
plotmeans(accuracy~pa_B,data=res2, frame=FALSE)
plotmeans(accuracy~method,data=res2, frame=FALSE)
ggplot(res2, aes(x = method, y = accuracy, interaction = pa, colour = pa)) + geom_boxplot()
ggplot(res2, aes(x = method, y = accuracy, interaction = pa, colour = pa)) + geom_boxplot()
res3=subset(res2,method="B"|method="D", select=c(accuracy,pa, species))
res3=subset(res2,method=="B"|method=="D", select=c(accuracy,pa, species))
res3=subset(res2,method=="B"|method=="D", select=c(accuracy,pa, species,method))
res3
ggplot(res3, aes(x = method, y = accuracy, interaction = pa, colour = pa)) + geom_boxplot()
stat <- summarySE(res3, measurevar="accuracu", groupvars=c("method","pa"))
stat <- summarySE(res3, measurevar="accuracy", groupvars=c("method","pa"))
library("Rmisc", lib.loc="~/R/R-3.6.1/library")
stat <- summarySE(res3, measurevar="accuracy", groupvars=c("method","pa"))
stat
stat <- summarySE(res3, measurevar="accuracy", groupvars=c("method","pa"),na.rm = T)
stat
ggplot(stat, aes(x=method, y=accuracy, colour=pa)) +
geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)
pd <- position_dodge(0.1) # move them .05 to the left and right
ggplot(stat, aes(x=method, y=accuracy, colour=pa)) +
geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)
ggplot(stat, aes(x=method, y=accuracy, colour=pa)) +
geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se), width=.1, position=pd) +
geom_point(position=pd)
ggplot(stat, aes(x=method, y=accuracy, colour=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)
ggplot(stat, aes(x=method, y=accuracy, colour=pa)) +
geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se), width=.1, position=pd)+
geom_point(position=pd)
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd, size=3)
ggplot(stat, aes(x=method, y=accuracy, colour=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd, size=3)
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)
stat$method=revalue(stat4method, c("B"="traditional", "D"="novel"))
stat$method=revalue(stat$method, c("B"="traditional", "D"="novel"))
ggplot(stat, aes(x=method, y=accuracy, colour=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
expand_limits(y=0) +                        # Expand y range
scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme_bw() +
theme(legend.justification=c(1,0),
legend.position=c(1,0))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
# Expand y range
scale_y_continuous(breaks=0:20*4) +         # Set tick every 4
theme_bw() +
theme(legend.justification=c(1,0),
legend.position=c(0,1))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
# Expand y range
# Set tick every 4
theme_bw() +
theme(legend.justification=c(1,0),
legend.position=c(0,1))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,0),
legend.position=c(0,1))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,0),
legend.position=c(1,0))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,0),
legend.position=c(1,1))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(1,1))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=3)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=10)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.1, position=pd) +
geom_point(position=pd, size=6)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.5, position=pd) +
geom_point(position=pd, size=6)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.3, position=pd) +
geom_point(position=pd, size=6)+
xlab("Validation method") +
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))               # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.3, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))               # Position legend in bottom right
p=ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.3, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))               # Position legend in bottom right
p
p=ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.2, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))               # Position legend in bottom right
p
p=ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.2, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))  +             # Position legend in bottom right
theme(text = element_text(size = 45))
p
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.2, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))  +             # Position legend in bottom right
theme(text = element_text(size = 15))
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.2, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95))  +             # Position legend in bottom right
theme(text = element_text(size = 20))
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.2, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95)),legend.box.backgound=element_rect()  +             # Position legend in bottom right
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.2, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95),legend.box.backgound=element_rect())  +             # Position legend in bottom right
theme(text = element_text(size = 20))
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.2, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95),
legend.box.backgound=element_rect())  +             # Position legend in bottom right
theme(text = element_text(size = 20))
ggplot(stat, aes(x=method, y=accuracy, colour=pa, group=pa)) +
geom_errorbar(aes(ymin=accuracy-ci, ymax=accuracy+ci), colour="black", width=.2, position=pd) +
geom_point(position=pd, size=6)+
ylab("Model transferability") +
scale_colour_hue(name="Data type",    # Legend label, use darker colors
breaks=c("pa", "abu"),
labels=c("Presence/absence", "Abundance"),
l=40) +                    # Use darker colors, lightness=40
theme_bw() +
theme(legend.justification=c(1,1),
legend.position=c(0.95,0.95),
legend.box.background=element_rect())  +             # Position legend in bottom right
theme(text = element_text(size = 20))
