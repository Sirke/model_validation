a<-c(b,a)
names(paY1)<-a
names(paY2)<-a
names(papred1)<-a
names(papred2)<-a
#seuraavaksi lasketaan erotukset periodin 1 ja 2 välilä
#abu
#obs
pacounts_gather<-gather(paY1,key="Yspecies",value="Yper1",Acrocephalus_palustris:Vanellus_vanellus)
pacounts_gather2<-gather(paY2,key="Yspecies",value="Yper2",Acrocephalus_palustris:Vanellus_vanellus)
payhd<-left_join(pacounts_gather,pacounts_gather2,by=c("grid_id"="grid_id","Yspecies"="Yspecies"))
payhd$difY<-payhd$Yper2-payhd$Yper1
#pred
papred_gather<-gather(papred1,key="Pspecies",value="Pper1",Acrocephalus_palustris:Vanellus_vanellus)
papred_gather2<-gather(papred2,key="Pspecies",value="Pper2",Acrocephalus_palustris:Vanellus_vanellus)
payhdPred<-left_join(papred_gather,papred_gather2,by=c("grid_id"="grid_id","Pspecies"="Pspecies"))
payhdPred$difPred<-payhdPred$Pper2-payhdPred$Pper1
#pa
abuKor<-left_join(payhd,payhdPred,by=c("grid_id"="grid_id","Yspecies"="Pspecies"))
keep<-c("Yspecies","difPred","difY")
abuKor<-abuKor[,keep,drop=F]
abuKor %>%
group_by(Yspecies) %>%
dplyr::summarise(pool_abu_change= cor(difPred, difY, use= "na.or.complete"))%T>%
write.csv('abu_pool50_results.csv',row.names=F)
#kaikki data sisään
res<-read.csv("results.csv")
pool_pa<-read.csv("pa_pool50_results.csv")
pool_abu<-read.csv("abu_pool50_results.csv")
#100km gridi
#pool_pa<-read.csv("pa_pool100_results.csv")
#pool_abu<-read.csv("abu_pool100_results.csv")
#yhdistely yhdeksi taulukoksi
pool_res<-inner_join(pool_pa,pool_abu,by="Yspecies")
res2<-inner_join(res,pool_res,by=c("species"="Yspecies"))
#tallennetaan omaksi taulukokseen jatkoa varten
write.csv(res2,"results_and_pooled.csv",row.names = F)
##lasketaan kaikille arvoille keskiarvot ja se:t
res2 %>% dplyr::select(2:11)%>%colMeans()
res2 %>% dplyr::select(2:11)%>%std.error()
#muokataan aineistoa
res3=res2[c(1,2,3,4,5,10,6,7,8,9,11)]
res3=gather(res3,"method","accuracy",2:11)
res3$method=as.factor(res3$method)
#plottailua
p=ggplot(res3,aes(x=method,y=accuracy))+geom_boxplot()
p + scale_x_discrete(limits=c("pa_A", "pa_B","pa_C","pa_D","pool_pa_change"))
p+ scale_x_discrete(limits=c("abu_A", "abu_B","abu_C","abu_D","pool_abu_change"))
res4=subset(res3,method=="pool_pa_change"|method=="pa_D")
#testi (two-way anova)
anova(lm(res4$accuracy~res4$species+res4$method))
res4=subset(res3,method=="pool_abu_change"|method=="abu_D")
anova(lm(res4$accuracy~res4$species+res4$method))
res4=subset(res3,method=="pool_abu_change"|method=="abu_D")
anova(lm(res4$accuracy~res4$species+res4$method))
summary(lm(res4$accuracy~res4$species+res4$method))
View(res4)
anova(lm(res4$accuracy~res4$species+res4$method))
res4=subset(res3,method=="pool_pa_change"|method=="pa_D")
#testi (two-way anova)
anova(lm(res4$accuracy~res4$species+res4$method))
aov(res4$accuracy~res4$species+res4$method)
summary(aov(res4$accuracy~res4$species+res4$method))
anova(lm(res4$accuracy~res4$species+res4$method))
summary(aov(res4$accuracy~res4$species+res4$method))
res4=subset(res3,method=="pool_abu_change"|method=="abu_D")
anova(lm(res4$accuracy~res4$species+res4$method))
t.test(res2$pool_pa_change,res2$pa_D, paired = T)
t.test(res2$pool_abu_change,res2$abu_D, paired = T)
t.test(res2$pool_pa_change,res2$pool_abu_change, paired=TRUE)
res4=subset(res3,method=="pool_abu_change"|method=="pool_pa_change")
View(res4)
anova(lm(res4$accuracy~res4$species+res4$method))
t.test(res4$pool_pa_change,res4$pool_abu_change, paired=TRUE)
t.test(res2$pool_pa_change,res2$pool_abu_change, paired=TRUE)
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)
Line=cbind(Line,Line2)
Line=cbind(Line,Line3)
Line=as.data.frame(Line)
#pdf("Pooled_Fig1.pdf")
#määrittää 3x3 matriisin johon kuvat piirretään
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))
View(res2)
plot(pa_B~pa_A,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"a) Distribution",cex=0.8)
# b)
plot(abu_B~abu_A,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"b) Abundance",cex=0.8)
# c)
plot(pa_D~pa_C,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)
# d)
plot(abu_D~abu_C,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)
# e)
plot(pool_pa_change~pa_D,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (D)",
ylab="Pooled prediction accuracy (change)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"e) Distribution, 50 km",cex=0.8)
# f)
plot(pool_abu_change~abu_D,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (D)",
ylab="Pooled prediction accuracy (change)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"f) Abundance, 50km", cex=0.8)
Line=c(-1,1)
Line2=c(-1,1)
Line3=c(0,0)
Line=cbind(Line,Line2)
Line=cbind(Line,Line3)
Line=as.data.frame(Line)
#pdf("Pooled_Fig1.pdf")
#määrittää 3x3 matriisin johon kuvat piirretään
layout(matrix(c(1,2,7,3,4,7,5,6,7), 3, 3, byrow = TRUE))
# a)
plot(pa_B~pa_A,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"a) Distribution",cex=0.8)
# b)
plot(abu_B~abu_A,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (A)",
ylab="Prediction accuracy (B)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"b) Abundance",cex=0.8)
# c)
plot(pa_D~pa_C,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"c) Distribution, 2 km",cex=0.8)
# d)
plot(abu_D~abu_C,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (C)",
ylab="Prediction accuracy (D)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"d) Abundance, 2 km",cex=0.8)
# e)
plot(pool_pa_change~pa_D,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (D)",
ylab="Pooled prediction accuracy (change)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"e) Distribution, 50 km",cex=0.8)
# f)
plot(pool_abu_change~abu_D,data=res2,xlim=c(-1,1),
ylim=c(-1,1),cex.axis=0.8,xlab="Prediction accuracy (D)",
ylab="Pooled prediction accuracy (change)")
lines(Line$Line,Line$Line2,lty="dashed")
lines(Line$Line,Line$Line3,col="grey",lty="dashed")
lines(Line$Line3,Line$Line,col="grey",lty="dashed")
text(-0.5,0.8,"f) Abundance, 50km", cex=0.8)
paketit<-c("nlme","readr","tidyr","dplyr","plyr","magrittr","purrr","ggplot2","ape","geiger","MuMin","psych","Hmisc")
lapply(paketit,library,character.only=T)
install.packages("MuMIn")
paketit<-c("nlme","readr","tidyr","dplyr","plyr","magrittr","purrr","ggplot2","ape","geiger","MuMin","psych","Hmisc")
lapply(paketit,library,character.only=T)
paketit<-c("nlme","readr","tidyr","dplyr","plyr","magrittr","purrr","ggplot2","ape","geiger","MuMIn","psych","Hmisc")
lapply(paketit,library,character.only=T)
getwd()
res<-read.csv("results_and_pooled.csv")
View(res)
traits<-read.csv("traits_table.csv",sep = ";")
View(traits)
res<-inner_join(res,traits,by="species")
View(res)
linnut <- read.nexus("output.nex")
linnut2<-linnut[[99]]
bm.birds=corBrownian(1,phy=linnut2)
lintupuu<-vcv.phylo(linnut2)
heatmap(lintupuu,Rowv = NA,Colv = NA)
View(res)
rownames(res)=res$species
View(res)
malli0 <- gls(pa_D ~ 1, data = results)
results<-inner_join(res,traits,by="species")
rownames(results)=results$species
malli0 <- gls(pa_D ~ 1, data = results)
malli1 <- gls(pa_D ~ Mig, data = results)
View(results)
res<-read.csv("results_and_pooled.csv")
traits<-read.csv("traits_table.csv",sep = ";")
results<-inner_join(res,traits,by="species")
#tallenna tarvittaessa omaksi taulukokseen
#write.csv(res,"accuracies_traits.csv",row.names = F)
View(results)
linnut <- read.nexus("output.nex")
#valitaan vain yksi puu, mikä tahansa sadasta
linnut2<-linnut[[99]]
#define a variance-covariance structure based on the model of Brownian evolution
bm.birds=corBrownian(1,phy=linnut2)
#tehdään fylogenialistasta matriisi
lintupuu<-vcv.phylo(linnut2)
#matriisin voi värittää havainnollistamaan lintulajien sukulaisuutta
heatmap(lintupuu,Rowv = NA,Colv = NA)
#aineiston rivien nimet muutetaan lattareiksi jolloin keskustelee fylogeniapuun kanssa
rownames(results)=results$species
malli0 <- gls(pa_D ~ 1, data = results)
malli1 <- gls(pa_D ~ Mig, data = results)
malli2 <- gls(pa_D ~ Hab, data = results)
malli3 <- gls(pa_D ~ log(Mass), data = results)
malli4 <- gls(pa_D ~ Prev, data = results)
malli5 <- gls(pa_D ~ Mig + Hab, data = results)
malli6 <- gls(pa_D ~ Hab + log(Mass), data = results)
malli7 <- gls(pa_D ~ Mig + log(Mass), data = results)
malli8 <- gls(pa_D ~ log(Mass)+Prev, data = results)
malli9 <- gls(pa_D ~ Mig +Prev, data = results)
malli10 <- gls(pa_D ~ Hab+Prev, data = results)
malli11 <- gls(pa_D ~ Mig + Hab + log(Mass), data = results)
malli12 <- gls(pa_D ~ Mig + Hab + Prev, data = results)
malli13 <- gls(pa_D ~ Mig + Prev + log(Mass), data = results)
malli14 <- gls(pa_D ~ Prev + Hab + log(Mass), data = results)
malli15 <- gls(pa_D ~ Mig + Hab + log(Mass)+Prev, data = results)
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
summary(model.avg(output1, revised.var = TRUE))
summary(malli0)
malli0 <- gls(pa_D ~ 1, data = results,correlation=bm.birds,method="ML" )
malli1 <- gls(pa_D ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(pa_D ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(pa_D ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(pa_D ~ Prev, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(pa_D ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(pa_D ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(pa_D ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(pa_D ~ log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(pa_D ~ Mig +Prev, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(pa_D ~ Hab+Prev, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(pa_D ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(pa_D ~ Mig + Hab + Prev, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(pa_D ~ Mig + Prev + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(pa_D ~ Prev + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(pa_D ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
summary(model.avg(output1, revised.var = TRUE))
summary(malli3)
malli0 <- gls(abu_D ~ 1, data = results)
malli1 <- gls(abu_D ~ Mig, data = results)
malli2 <- gls(abu_D ~ Hab, data = results)
malli3 <- gls(abu_D ~ log(Mass), data = results)
malli4 <- gls(abu_D ~ Prev, data = results)
malli5 <- gls(abu_D ~ Mig + Hab, data = results)
malli6 <- gls(abu_D ~ Hab + log(Mass), data = results)
malli7 <- gls(abu_D ~ Mig + log(Mass), data = results)
malli8 <- gls(abu_D ~ log(Mass)+Prev, data = results)
malli9 <- gls(abu_D ~ Mig +Prev, data = results)
malli10 <- gls(abu_D ~ Hab+Prev, data = results)
malli11 <- gls(abu_D ~ Mig + Hab + log(Mass), data = results)
malli12 <- gls(abu_D ~ Mig + Hab + Prev, data = results)
malli13 <- gls(abu_D ~ Mig + Prev + log(Mass), data = results)
malli14 <- gls(abu_D ~ Prev + Hab + log(Mass), data = results)
malli15 <- gls(abu_D ~ Mig + Hab + log(Mass)+Prev, data = results)
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
summary(malli0)
malli0 <- gls(abu_D ~ 1, data = results,correlation=bm.birds,method="ML" )
malli1 <- gls(abu_D ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(abu_D ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(abu_D ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(abu_D ~ Prev, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(abu_D ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(abu_D ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(abu_D ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(abu_D ~ log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(abu_D ~ Mig +Prev, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(abu_D ~ Hab+Prev, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(abu_D ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(abu_D ~ Mig + Hab + Prev, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(abu_D ~ Mig + Prev + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(abu_D ~ Prev + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(abu_D ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
summary(model.avg(output1, revised.var = TRUE))
summary(malli9)
summary(malli13)
malli0 <- gls(pool_pa_change ~ 1, data = results)
malli1 <- gls(pool_pa_change ~ Mig, data = results)
malli2 <- gls(pool_pa_change ~ Hab, data = results)
malli3 <- gls(pool_pa_change ~ log(Mass), data = results)
malli4 <- gls(pool_pa_change ~ Prev, data = results)
malli5 <- gls(pool_pa_change ~ Mig + Hab, data = results)
malli6 <- gls(pool_pa_change ~ Hab + log(Mass), data = results)
malli7 <- gls(pool_pa_change ~ Mig + log(Mass), data = results)
malli8 <- gls(pool_pa_change ~ log(Mass)+Prev, data = results)
malli9 <- gls(pool_pa_change ~ Mig +Prev, data = results)
malli10 <- gls(pool_pa_change ~ Hab+Prev, data = results)
malli11 <- gls(pool_pa_change ~ Mig + Hab + log(Mass), data = results)
malli12 <- gls(pool_pa_change ~ Mig + Hab + Prev, data = results)
malli13 <- gls(pool_pa_change ~ Mig + Prev + log(Mass), data = results)
malli14 <- gls(pool_pa_change ~ Prev + Hab + log(Mass), data = results)
malli15 <- gls(pool_pa_change ~ Mig + Hab + log(Mass)+Prev, data = results)
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
summary(model.avg(output1, revised.var = TRUE))
summary(malli0)
malli0 <- gls(pool_pa_change ~ 1, data = results,correlation=bm.birds,method="ML" )
malli1 <- gls(pool_pa_change ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(pool_pa_change ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(pool_pa_change ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(pool_pa_change ~ Prev, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(pool_pa_change ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(pool_pa_change ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(pool_pa_change ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(pool_pa_change ~ log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(pool_pa_change ~ Mig +Prev, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(pool_pa_change ~ Hab+Prev, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(pool_pa_change ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(pool_pa_change ~ Mig + Hab + Prev, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(pool_pa_change ~ Mig + Prev + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(pool_pa_change ~ Prev + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(pool_pa_change ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
summary(model.avg(output1, revised.var = TRUE))
malli0 <- gls(pool_abu_change ~ 1, data = results)
malli1 <- gls(pool_abu_change ~ Mig, data = results)
malli2 <- gls(pool_abu_change ~ Hab, data = results)
malli3 <- gls(pool_abu_change ~ log(Mass), data = results)
malli4 <- gls(pool_abu_change ~ Prev, data = results)
malli5 <- gls(pool_abu_change ~ Mig + Hab, data = results)
malli6 <- gls(pool_abu_change ~ Hab + log(Mass), data = results)
malli7 <- gls(pool_abu_change ~ Mig + log(Mass), data = results)
malli8 <- gls(pool_abu_change ~ log(Mass)+Prev, data = results)
malli9 <- gls(pool_abu_change ~ Mig +Prev, data = results)
malli10 <- gls(pool_abu_change ~ Hab+Prev, data = results)
malli11 <- gls(pool_abu_change ~ Mig + Hab + log(Mass), data = results)
malli12 <- gls(pool_abu_change ~ Mig + Hab + Prev, data = results)
malli13 <- gls(pool_abu_change ~ Mig + Prev + log(Mass), data = results)
malli14 <- gls(pool_abu_change ~ Prev + Hab + log(Mass), data = results)
malli15 <- gls(pool_abu_change ~ Mig + Hab + log(Mass)+Prev, data = results)
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
malli0 <- gls(pool_abu_change ~ 1, data = results)
malli1 <- gls(pool_abu_change ~ Mig, data = results)
malli2 <- gls(pool_abu_change ~ Hab, data = results)
malli3 <- gls(pool_abu_change ~ log(Mass), data = results)
malli4 <- gls(pool_abu_change ~ Prev, data = results)
malli5 <- gls(pool_abu_change ~ Mig + Hab, data = results)
malli6 <- gls(pool_abu_change ~ Hab + log(Mass), data = results)
malli7 <- gls(pool_abu_change ~ Mig + log(Mass), data = results)
malli8 <- gls(pool_abu_change ~ log(Mass)+Prev, data = results)
malli9 <- gls(pool_abu_change ~ Mig +Prev, data = results)
malli10 <- gls(pool_abu_change ~ Hab+Prev, data = results)
malli11 <- gls(pool_abu_change ~ Mig + Hab + log(Mass), data = results)
malli12 <- gls(pool_abu_change ~ Mig + Hab + Prev, data = results)
malli13 <- gls(pool_abu_change ~ Mig + Prev + log(Mass), data = results)
malli14 <- gls(pool_abu_change ~ Prev + Hab + log(Mass), data = results)
malli15 <- gls(pool_abu_change ~ Mig + Hab + log(Mass)+Prev, data = results)
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
output1
summary(malli0)
malli0 <- gls(pool_abu_change ~ 1, data = results,correlation=bm.birds,method="ML" )
malli1 <- gls(pool_abu_change ~ Mig, data = results,correlation=bm.birds,method="ML")
malli2 <- gls(pool_abu_change ~ Hab, data = results,correlation=bm.birds,method="ML")
malli3 <- gls(pool_abu_change ~ log(Mass), data = results,correlation=bm.birds,method="ML")
malli4 <- gls(pool_abu_change ~ Prev, data = results,correlation=bm.birds,method="ML")
malli5 <- gls(pool_abu_change ~ Mig + Hab, data = results,correlation=bm.birds,method="ML")
malli6 <- gls(pool_abu_change ~ Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli7 <- gls(pool_abu_change ~ Mig + log(Mass), data = results,correlation=bm.birds,method="ML")
malli8 <- gls(pool_abu_change ~ log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
malli9 <- gls(pool_abu_change ~ Mig +Prev, data = results,correlation=bm.birds,method="ML")
malli10 <- gls(pool_abu_change ~ Hab+Prev, data = results,correlation=bm.birds,method="ML")
malli11 <- gls(pool_abu_change ~ Mig + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli12 <- gls(pool_abu_change ~ Mig + Hab + Prev, data = results,correlation=bm.birds,method="ML")
malli13 <- gls(pool_abu_change ~ Mig + Prev + log(Mass), data = results,correlation=bm.birds,method="ML")
malli14 <- gls(pool_abu_change ~ Prev + Hab + log(Mass), data = results,correlation=bm.birds,method="ML")
malli15 <- gls(pool_abu_change ~ Mig + Hab + log(Mass)+Prev, data = results,correlation=bm.birds,method="ML")
#mallin valintaa MuMin paketin avulla
output1<-model.sel(malli0,malli1,malli2,malli3,malli4,malli5,malli6,malli7,malli8,malli9,malli10,malli11,malli12,malli13,malli14,malli15)
# AICc Table
output1
summary(model.avg(output1, revised.var = TRUE))
summary(malli8)
results$logmass<-log(results$Mass)
op<-par(mfrow=c(2,3),mar=c(5,4,1,2))
plot(malli8,add.smooth = F,which = 1)
E<-resid(malli8)
hist(E, xlab = "residuals",main = "")
plot(results$Prev,E,xlab = "prevalence",ylab="residuals")
plot(results$Hab,E,xlab = "habitat",ylab="residuals")
plot(results$Mig,E,xlab = "migration",ylab="residuals")
plot(results$logmass,E,xlab = "logMass",ylab="residuals")
par(op)
op<-par(mfrow=c(2,3),mar=c(5,4,1,2))
plot(malli8,add.smooth = F,which = 1)
E<-resid(malli8)
hist(E, xlab = "residuals",main = "")
plot(results$Prev,E,xlab = "prevalence",ylab="residuals")
plot(results$Hab,E,xlab = "habitat",ylab="residuals")
plot(results$Mig,E,xlab = "migration",ylab="residuals")
plot(results$logmass,E,xlab = "logMass",ylab="residuals")
par(op)
summary(malli14)
summary(malli14)
summary(malli15)
summary(malli13)
summary(malli13)
summary(malli8)
summary(malli14)
op<-par(mfrow=c(2,3),mar=c(5,4,1,2))
plot(malli14,add.smooth = F,which = 1)
E<-resid(malli14)
hist(E, xlab = "residuals",main = "")
plot(results$Prev,E,xlab = "prevalence",ylab="residuals")
plot(results$Hab,E,xlab = "habitat",ylab="residuals")
plot(results$Mig,E,xlab = "migration",ylab="residuals")
plot(results$logmass,E,xlab = "logMass",ylab="residuals")
par(op)
op<-par(mfrow=c(1,2),mar=c(5,4,1,2))
boxplot(pool_abu_change~Hab,data=results,ylab="regional prediction accuracy of change",xlab="Habitat")
par(op)
op<-par(mfrow=c(1,2),mar=c(5,4,1,2))
boxplot(pool_abu_change~Hab,data=results,ylab="regional prediction accuracy of change",xlab="Habitat")
plot(pool_abu_change~Prev, data = results,ylab="regional prediction accuracy of change",xlab="Prevalence")
abline(lm(pool_abu_change~Prev,data = results))
par(op)
op<-par(mfrow=c(1,2),mar=c(5,4,1,2))
boxplot(pool_pa_change~Hab,data=results,ylab="regional prediction accuracy of change",xlab="Habitat")
plot(pool_pa_change~Prev, data = results,ylab="regional prediction accuracy of change",xlab="Prevalence")
abline(lm(pool_pa_change~Prev,data = results))
par(op)
ggplot(results, aes(x = Hab, y = pool_pa_change)) +
geom_boxplot(fill = "grey80", colour = "blue") +
scale_x_discrete() + xlab("Habitat") +
ylab("regional prediction accuracy of change")
ggplot(results, aes(x = Prev, y = pool_pa_change)) +
geom_point(shape=1, colour = "blue") +
geom_smooth(col="black", size=1,se=FALSE) + xlab("Prevalence") +
ylab("regional prediction accuracy of change")
op<-par(mfrow=c(1,2),mar=c(5,4,1,2))
boxplot(pool_pa_change~Hab,data=results,ylab="regional prediction accuracy of change",xlab="Habitat")
plot(pool_pa_change~Prev, data = results,ylab="regional prediction accuracy of change",xlab="Prevalence")
abline(lm(pool_pa_change~Prev,data = results))
par(op)
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pool_pa_change~Hab,data=results,ylab="pool_pa_D",xlab="Habitat")
plot(pool_pa_change~Prev, data = results,ylab="pool_pa_D",xlab="Prevalence")
abline(lm(pool_pa_change~Prev,data = results))
boxplot(pool_pa_change~Mig,data=results,ylab="pool_pa_D",xlab="Migration")
plot(pool_pa_change~logmass, data = results,ylab="pool_pa_D",xlab="log(Mass)")
abline(lm(pool_pa_change~logmass,data = results))
par(op)
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pool_abu_change~Hab,data=results,ylab="pool_abu_D",xlab="Habitat")
plot(pool_abu_change~Prev, data = results,ylab="pool_abu_D",xlab="Prevalence")
abline(lm(pool_abu_change~Prev,data = results))
boxplot(pool_abu_change~Mig,data=results,ylab="pool_abu_D",xlab="Migration")
plot(pool_abu_change~logmass, data = results,ylab="pool_abu_D",xlab="log(Mass)")
abline(lm(pool_abu_change~logmass,data = results))
par(op)
op<-par(mfrow=c(2,2),mar=c(5,4,1,2))
boxplot(pa_D~Hab,data=results,ylab="pa_D",xlab="Habitat")
plot(pa_D~Prev, data = results,ylab="pa_D",xlab="Prevalence")
abline(lm(pa_D~Prev,data = results))
boxplot(pa_D~Mig,data=results,ylab="pa_D",xlab="Migration")
plot(pa_D~logmass, data = results,ylab="pa_D",xlab="log(Mass)")
abline(lm(pa_D~logmass,data = results))
par(op)
```{r }
